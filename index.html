<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Nextera Enqu√™te ouverte ‚Äì Tableau de bord</title>
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://i.imgur.com/8XDJPhr.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- AmCharts Library -->
  <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/percent.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/flow.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/radar.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/plugins/wordCloud.js"></script>

  <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/geodata/franceLow.js"></script>
  <script src="https://cdn.amcharts.com/lib/5/plugins/exporting.js"></script>

  <style>
    :root {
      --primary: #8FD2D2;
      --dark: #0E3F2D;
      --accent: #15616D;
      --neutral: #A0A0A0;
      --bg-light: #F5F8FA;
      --sidebar-bg: #F0FAFC;
      --sidebar-border: #D0E6E6;
      --sidebar-width: 220px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      display: flex;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-light);
    }

    .analysis-toggle {
      margin-top: 15px;
      background-color: #15616D;
      color: #fff;
      border: none;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      border-radius: 6px;
    }

    .analysis-content {
      display: none;
      margin-top: 15px;
      border-left: 4px solid #15616D;
      padding-left: 15px;
      animation: fadeIn 0.4s ease-in-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .sidebar {
      width: 240px;
      height: 100vh;
      background: linear-gradient(135deg, #97cce4 0%, #306e8b 100%);
      color: white;
      padding: 20px;
      overflow-y: auto;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 1000;
    }

    .main-content {
      margin-left: 240px;
      padding: 20px;
      flex: 1;
    }

    .logo-container {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.2);
    }

    .logo-container img {
      max-width: 200px;
      height: auto;
    }

    .filter-section {
      margin-bottom: 25px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 20px;
      backdrop-filter: blur(10px);
    }

    .section-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: "üìä";
      font-size: 18px;
    }

    .sections-title::before {
      content: "üìã";
    }

    .typeahead-container {
      position: relative;
      margin-bottom: 15px;
    }

    .typeahead-input {
      width: 100%;
      padding: 12px 16px;
      border: none;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.9);
      color: #333;
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .typeahead-input:focus {
      outline: none;
      background: white;
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.3);
    }

    .typeahead-input::placeholder {
      color: #666;
    }

    .checkbox-list {
      max-height: 300px;
      overflow-y: auto;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      padding: 10px 12px;
      border-radius: 6px;
      margin-bottom: 4px;
      transition: all 0.2s ease;
      cursor: pointer;
      position: relative;
    }

    .checkbox-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .checkbox-item.hidden {
      display: none;
    }

    .checkbox-item.select-all {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.3);
      font-weight: 600;
      margin-bottom: 8px;
    }

    .checkbox-item.parent-item {
      font-weight: 500;
      background: rgba(255, 255, 255, 0.1);
    }

    .checkbox-item.child-item {
      margin-left: 20px;
      padding-left: 8px;
      background: rgba(255, 255, 255, 0.05);
      border-left: 2px solid rgba(255, 255, 255, 0.3);
    }

    .checkbox-item input[type="checkbox"] {
      margin-right: 10px;
      transform: scale(1.1);
      accent-color: #4CAF50;
    }

    .checkbox-item label {
      cursor: pointer;
      font-size: 14px;
      font-weight: 400;
      flex: 1;
      color: rgba(255, 255, 255, 0.9);
    }

    .expand-toggle {
      margin-left: auto;
      background: none;
      border: none;
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      padding: 2px 6px;
      border-radius: 3px;
      transition: all 0.2s ease;
    }

    .expand-toggle:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
    }

    .clear-filters {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 12px;
      margin-top: 10px;
      transition: all 0.3s ease;
    }

    .clear-filters:hover {
      background: rgba(255, 255, 255, 0.3);
    }

    .selected-count {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
      margin-top: 8px;
    }

    /* Custom scrollbar */
    .sidebar::-webkit-scrollbar,
    .checkbox-list::-webkit-scrollbar {
      width: 6px;
    }

    .sidebar::-webkit-scrollbar-track,
    .checkbox-list::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb,
    .checkbox-list::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover,
    .checkbox-list::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.5);
    }

    /* Animation for filtered items */
    .checkbox-item {
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-5px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Responsive design */
    @media (max-width: 1024px) {
      .sidebar {
        width: 240px;
      }

      .main-content {
        margin-left: 240px;
      }
    }

    @media (max-width: 640px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }

      .main-content {
        margin-left: 0;
      }
    }

    .content {
      flex: 1;
      padding: 20px;
      background-color: var(--bg-light);
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    header h1 {
      font-size: 24px;
      color: var(--dark);
    }

    header h4 {
      /* font-size: 24px; */
      color: var(--dark);
    }

    /* 
    .filters {
      display: flex;
      gap: 10px;
    }

    .filters select {
      padding: 6px;
      border-radius: 4px;
      border: 1px solid #ccc;
    } */

    /* .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 20px;
    } */
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      /* ‚¨ÖÔ∏è 2 fixed columns */
      gap: 20px;
    }

    @media (max-width: 1000px) {
      .grid {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid-custom {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      /* ‚¨ÖÔ∏è 4 fixed columns */
      gap: 20px;
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
    }

    @media (max-width: 400px) {
      .grid-custom {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid0 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      /* ‚¨ÖÔ∏è 4 fixed columns */
      gap: 20px;
      /* width: 100%;
      max-width: 500px;
      margin: 0 auto; */
    }

    @media (max-width: 400px) {
      .grid0 {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid0>.chart-box:first-child {
      grid-column: span 3;
      /* Span 3 columns */
    }

    .grid0>.chart-box:last-child {
      grid-column: span 1;
      /* Span 1 column */
    }

    .grid1 {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      /* ‚¨ÖÔ∏è 4 fixed columns */
      gap: 20px;
      width: 100%;
      max-width: 920px;
      /* Or any max width you like */
      margin: 0 auto;
    }

    @media (max-width: 400px) {
      .grid1 {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid2 {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      /* ‚¨ÖÔ∏è 4 fixed columns */
      gap: 20px;
    }

    @media (max-width: 1000px) {
      .grid2 {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid3 {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      /* ‚¨ÖÔ∏è 3 fixed columns */
      gap: 20px;
    }

    @media (max-width: 1000px) {
      .grid3 {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .grid4 {
      display: grid;
      grid-template-columns: repeat(1, 1fr);
      /* ‚¨ÖÔ∏è 4 fixed columns */
      gap: 20px;
      width: 100%;
      /* max-width: 1000px; */
      margin: 0 auto;
    }

    @media (max-width: 400px) {
      .grid4 {
        grid-template-columns: 1fr;
        /* Stack on smaller screens */
      }
    }

    .chart-box {
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.06);
    }

    .chart-box h3 {
      margin-bottom: 10px;
      font-size: 16px;
      color: var(--accent);
    }

    .chart-container {
      width: 100%;
      height: 450px;
    }

    .chart-grid-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      max-width: 100%;
      height: 700px;
      margin-top: 20px;
    }

    .chart-grid-item {
      width: 100%;
      height: 500px;
      position: relative;
    }

    #chart2.chart-container {
      height: 600px;
    }

    #chart4.chart-container {
      height: 450px;
    }

    .manual-legend {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      /* Space between legend items */
      padding: 10px 0;
      flex-wrap: wrap;
      /* Allow wrapping on smaller screens */
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      /* Space between color box and label */
    }

    .legend-color {
      width: 14px;
      height: 14px;
      border-radius: 2px;
      /* Slightly rounded corners for a polished look */
      display: inline-block;
    }

    .legend-label {
      font-size: 16px;
      color: #666666;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    .manual-legend2 {
      display: flex;
      justify-content: flex-start;
      /* Align items to the left */
      align-items: center;
      gap: 20px;
      padding: 10px 0;
      flex-wrap: wrap;
      max-width: 800px;
      /* Controls the total width to maintain 2 items per row */
      margin: 0 auto;
      /* Center the legend container itself on the page */
    }

    .legend-item2 {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 30%;
      /* Ensures 2 items fit per row with some gap */
      /* margin-bottom: 10px; */
    }

    .legend-color2 {
      width: 14px;
      height: 14px;
      border-radius: 2px;
      display: inline-block;
    }

    .legend-label2 {
      font-size: 16px;
      color: #666666;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    .legend-item3 {
      display: flex;
      align-items: center;
      gap: 8px;
      width: 40%;
      /* Ensures 2 items fit per row with some gap */
      /* margin-bottom: 10px; */
    }

    .legend-color3 {
      width: 14px;
      height: 14px;
      border-radius: 2px;
      display: inline-block;
    }

    .legend-label3 {
      font-size: 16px;
      color: #666666;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }

    #chart2.chart-grid-container {
      position: relative;
    }

    #chart4.chart-grid-container {
      position: relative;
    }

    #chart3.chart-container {
      height: 700px;
    }

    #chart6.chart-container {
      height: 480px;
    }

    #chart1.chart-container {
      height: 500px;
    }

    #chart5.chart-container {
      height: 700px;
    }

    #chart6 .company-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      /* justify-content: space-between; */
    }

    #chart6 .company-item {
      flex: 1 1 calc(25% - 10px);
      min-width: 80px;
      max-width: 150px;
      text-align: center;
      /* padding-bottom: 10px; */
    }

    /* #chart6 .company-item img {
      width: 100%;
      height: auto;
    } */

    .tabs {
      margin-bottom: 10px;
    }

    .tab-button {
      background-color: #ffffff;
      border: 1px solid #15616D;
      color: #15616D;
      padding: 5px 12px;
      margin-right: 5px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.3s;
    }

    .tab-button:hover {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button.active {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button3 {
      background-color: #ffffff;
      border: 1px solid #15616D;
      color: #15616D;
      padding: 5px 12px;
      margin-right: 5px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.3s;
    }

    .tab-button3:hover {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button3.active {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button4 {
      background-color: #ffffff;
      border: 1px solid #15616D;
      color: #15616D;
      padding: 5px 12px;
      margin-right: 5px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.3s;
    }

    .tab-button4:hover {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button4.active {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button5 {
      background-color: #ffffff;
      border: 1px solid #15616D;
      color: #15616D;
      padding: 5px 12px;
      margin-right: 5px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.3s;
    }

    .tab-button5:hover {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button5.active {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button6 {
      background-color: #ffffff;
      border: 1px solid #15616D;
      color: #15616D;
      padding: 5px 12px;
      margin-right: 5px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: 0.3s;
    }

    .tab-button6:hover {
      background-color: #15616D;
      color: #fff;
    }

    .tab-button6.active {
      background-color: #15616D;
      color: #fff;
    }


    .status-grid-rowed {
      display: flex;
      flex-direction: column;
      gap: 14px;
      margin-top: 20px;
    }

    .status-row {
      display: grid;
      grid-template-columns: 200px repeat(4, 1fr);
      /* 1 for label, 4 for ES values */
      gap: 10px;
      align-items: center;
    }

    .status-category {
      font-weight: bold;
      font-size: 15px;
      color: #15616D;
    }

    .status-value {
      background-color: #f5f7fa;
      padding: 10px;
      text-align: center;
      border-radius: 8px;
      font-size: 14px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      font-weight: 500;
    }

    .status-value-title {
      /* background-color: #f5f7fa; */
      padding: 10px;
      text-align: center;
      /* border-radius: 8px; */
      font-size: 14px;
      /* box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08); */
      font-weight: 500;
    }


    /* Category Colors */
    .emploi {
      background-color: #E6F0F9;
      border-left: 4px solid #457B9D;
    }

    .recherche {
      background-color: #FAF2E6;
      border-left: 4px solid #D69B5A;
    }

    .etudes {
      background-color: #E6F7F4;
      border-left: 4px solid #2A9D8F;
    }

    .inactif {
      background-color: #F9E9EC;
      border-left: 4px solid #A77A82;
    }

    .non {
      background-color: #f7e6f9;
      border-left: 4px solid #8d459d;
    }

    .map-container {
      width: 600px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      padding: 20px;
    }

    h2 {
      text-align: center;
      margin-bottom: 10px;
    }

    svg {
      width: 100%;
      height: auto;
    }

    .region:hover {
      stroke: #000;
      stroke-width: 1.5px;
      cursor: pointer;
    }


    .chart-content {
      display: flex;
      gap: 20px;
      align-items: flex-start;
    }

    .region-list {
      flex: 0 0 200px;
      /* Fixed width for the list */
      font-size: 14px;
    }

    #pieChartTopSalariesLegend {
      margin-top: 10px;
      display: flex;
      justify-content: flex-start;
      flex-direction: column;
      align-items: stretch;
      font-family: Arial, sans-serif;
    }

    #chartdivSankee {
      width: 100%;
      height: 500px;
    }

    /* Button container for multiple buttons */
    .button-container {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 5px;
      z-index: 10;
    }

    /* Base button styles */
    .info-button {
      /* background: #e8f0ee; */
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      /* box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); */
    }

    .info-button:hover {
      background: #dda681;
      transform: scale(1.1);
    }

    .info-button img {
      width: 18px;
      height: 18px;
    }

    /* Different button variations */
    .info-button.primary {
      /* background: #1E9180; */
    }

    .info-button.primary:hover {
      background: #95cdd4;
    }

    .info-button.secondary {
      /* background: #f0f8ff; */
    }

    .info-button.secondary:hover {
      background: #bbaafa;
    }

    .info-button.danger {
      /* background: #ffebee; */
    }

    .info-button.danger:hover {
      background: #d32f2f;
    }

    /* Alternative: Horizontal layout at the top */
    .top-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-bottom: 15px;
    }

    .top-button {
      /* background: #1E9180; */
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 12px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      transition: all 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .top-button:hover {
      background: #00454D;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .top-button.outline {
      background: transparent;
      color: #1E9180;
      border: 1px solid #1E9180;
    }

    .top-button.outline:hover {
      background: #1E9180;
      color: white;
    }

    /* Chart content styles */
    .chart-content h3 {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 18px;
      font-weight: 600;
      color: #00454D;
      margin-bottom: 10px;
    }

    .chart-content .percentage {
      color: #1E9180;
      font-size: 40px;
      font-weight: bold;
      margin: 0;
    }

    .chart-box .percentage {
      color: #1E9180;
      font-size: 40px;
      font-weight: bold;
      margin: 0;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      animation: fadeIn 0.3s ease-out;
    }

    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      /* background-color: white; */
      background-color: #eaf1f3;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      max-width: 1200px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      transform: scale(0.8);
      animation: modalSlideIn 0.3s ease-out forwards;
    }

    .close-button {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #ff4757;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .close-button:hover {
      background: #ff3742;
      transform: scale(1.1);
    }

    .close-button svg {
      width: 16px;
      height: 16px;
      fill: white;
    }

    /* Detailed Chart in Modal */
    .detailed-chart {
      text-align: center;
      background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
      padding: 30px 30px 0px 30px;
      border-radius: 10px;
      color: white;
      /* margin-bottom: 20px; */
    }

    .detailed-chart h2 {
      margin-top: 0;
      margin-bottom: 20px;
      font-size: 24px;
      color: #0E3F2D
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .stat-item {
      background: rgba(255, 255, 255, 0.1);
      padding: 15px;
      border-radius: 8px;
      backdrop-filter: blur(10px);
    }

    .stat-number {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 14px;
      opacity: 0.9;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes modalSlideIn {
      from {
        transform: scale(0.8);
        opacity: 0;
      }

      to {
        transform: scale(1);
        opacity: 1;
      }
    }



    .export-container {
      position: absolute;
      top: 20px;
      right: 20px;
    }

    .export-button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 10px 16px;
      font-size: 14px;
      border-radius: 6px;
      cursor: pointer;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: white;
      border: 1px solid #ccc;
      min-width: 160px;
      z-index: 1;
      margin-top: 5px;
      border-radius: 4px;
      overflow: hidden;
    }

    .dropdown-content button {
      background: white;
      border: none;
      width: 100%;
      padding: 10px;
      text-align: left;
      cursor: pointer;
    }

    .dropdown-content button:hover {
      background-color: #f1f1f1;
    }

    .show-dropdown .dropdown-content {
      display: block;
    }


    /* Alternative Flexbox Layout */
    .flex-content {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 30px;
      margin: 20px 0;
    }

    .flex-icon {
      flex-shrink: 0;
    }

    .flex-text {
      text-align: center;
    }
  </style>
</head>

<body>

  <aside class="sidebar">
    <div class="logo-container">
      <img
        src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/Nextera%20Logo%20Career%20Insight%20White%20text.png"
        alt="Nextera Logo">
    </div>

    <!-- Source Filter Section -->
    <div class="filter-section">
      <div class="section-title">Certification</div>
      <div class="typeahead-container">
        <input type="text" class="typeahead-input" id="sourceTypeahead" placeholder="Rechercher une Certification..."
          autocomplete="off">
      </div>
      <div class="checkbox-list" id="sourceCheckboxList">
        <!-- Source checkboxes will be populated by JavaScript -->
      </div>
      <div class="selected-count" id="sourceCount">0 source(s) s√©lectionn√©e(s)</div>
      <button class="clear-filters" onclick="clearSourceFilters()">Appliquer les Filtres</button>
    </div>

    <!-- Sections Filter Section -->
    <div class="filter-section">
      <div class="section-title sections-title">Sections</div>
      <div class="checkbox-list" id="sectionsCheckboxList">
        <!-- Section checkboxes will be populated by JavaScript -->
      </div>
      <div class="selected-count" id="sectionsCount">0 section(s) s√©lectionn√©e(s)</div>
      <button class="clear-filters" onclick="clearSectionFilters()">Appliquer les Filtres</button>
    </div>
  </aside>

  <main class="main-content">
    <header>
      <h1>RDC 2022 - Enqu√™tes d'Employabilit√©</h1>
      <h4>EE1 : Certification &nbsp;| &nbsp;
        EE2 : Apr√®s 6 mois &nbsp;| &nbsp;
        EE3 : Apr√®s 12 mois &nbsp;| &nbsp;
        EE4 : Apr√®s 24 mois
      </h4>
    </header>

    <h2 style="color:#15616D; margin-bottom: 20px;">Poursuite d'√©tudes</h2>
    <div class="grid3" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative; text-align: center; background-color: rgb(226, 246, 250);">
        <div class="button-container">
          <button class="info-button" onclick="openModal()" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png" alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="openModalScope()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <br>
        <h3
          style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D	; margin: 10px 0 10px 0;">
          <strong>Poursuite d‚Äô√©tude √† 6 mois apr√®s la certification</strong>
        </h3>
        <p style="color:#1E9180 ; font-size: 40px;"><strong>57%</strong></p>
      </div>

      <!-- <div class="chart-box" style="text-align: center; background-color: rgb(226, 250, 233);"> -->
      <div class="chart-box" style="position: relative; text-align: center; background-color: rgb(226, 250, 233);">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <br>
        <h3
          style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D	; margin: 10px 0 10px 0;">
          <strong>Domaine de Poursuite d'√©tudes</strong>
        </h3>
        <table style="margin: 0 auto; text-align: center;">
          <thead>
            <tr style="font-size: 15px; color: #6B7280 ">
              <th style="padding-left: 15px;">Immobilier</th>
              <th style="padding-left: 15px;">Commerce</th>
              <th style="padding-left: 15px;">Banque / Assurance</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-size: 18px; color: #159E8E">
              <td><strong>27%</strong></td>
              <td><strong>5%</strong></td>
              <td><strong>4%</strong></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="chart-box" style="position: relative; text-align: center; background-color: rgb(250, 239, 226);">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <br>
        <h3
          style="font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D	; margin: 10px 0 10px 0;">
          <strong>Niveau TOP cible BAC+5</strong>
        </h3>
        <p style="color:#1E9180 ; font-size: 40px;"><strong>80%</strong></p>
      </div>
    </div>
    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Poursuivre les √©tudes.</h3><br>
        <div id="pieChartContinueStudy" class="chart-container" style="height: 300px;"></div>
        <div class="manual-legend2">
          <div class="legend-item3">
            <span class="legend-color3" style="background-color: #67b7dc;"></span>
            <span class="legend-label3">Poursuit des √©tudes <span style="color: #67b7dc; font-size: 16px"><strong>182
                  (57%)</strong></span></span>
          </div>
          <div class="legend-item3">
            <span class="legend-color3" style="background-color: #6794dc;"></span>
            <span class="legend-label3">Ne poursuit pas d'√©tudes <span
                style="color: #6794dc; font-size: 16px"><strong>136 (43%)</strong></span></span>
          </div>

        </div>
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Poursuivre les √©tudes dans la m√™me √©cole.</h3><br>
        <div id="pieChartSameSchool" class="chart-container" style="height: 300px;"></div>
        <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2">Meme ecole <span style="color: #67b7dc; font-size: 16px"><strong>86
                  (47%)</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2">Ecole differente <span style="color: #6794dc; font-size: 16px"><strong>97
                  (53%)</strong></span></span>
          </div>
        </div>
      </div>
    </div>

    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart2-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Statut Professionnel : Situation apr√®s la certification</h3>
        <div class="status-grid-rowed">
          <div class="status-row" style="color: #00454D">
            <div class="status-category"></div>
            <div class="status-value-title"><strong>EE1</strong></div>
            <div class="status-value-title"><strong>EE2</strong></div>
            <div class="status-value-title"><strong>EE3</strong></div>
            <div class="status-value-title"><strong>EE4</strong></div>
          </div>
          <div class="status-row">
            <div class="status-category">A un emploi</div>
            <div class="status-value" style="background-color: #E6F0F9; border-left: 4px solid #457B9D;">0%</div>
            <div class="status-value" style="background-color: #E6F0F9; border-left: 4px solid #457B9D;">75%</div>
            <div class="status-value" style="background-color: #E6F0F9; border-left: 4px solid #457B9D;">70%</div>
            <div class="status-value" style="background-color: #E6F0F9; border-left: 4px solid #457B9D;">73%</div>
          </div>
          <div class="status-row">
            <div class="status-category">Recherche</div>
            <div class="status-value" style="background-color: #FAF2E6; border-left: 4px solid #D69B5A;">44%</div>
            <div class="status-value" style="background-color: #FAF2E6; border-left: 4px solid #D69B5A;">14%</div>
            <div class="status-value" style="background-color: #FAF2E6; border-left: 4px solid #D69B5A;">9%</div>
            <div class="status-value" style="background-color: #FAF2E6; border-left: 4px solid #D69B5A;">3%</div>
          </div>
          <div class="status-row">
            <div class="status-category">Poursuit des √©tudes</div>
            <div class="status-value" style="background-color: #E6F7F4; border-left: 4px solid #2A9D8F;">56%</div>
            <div class="status-value" style="background-color: #E6F7F4; border-left: 4px solid #2A9D8F;">3%</div>
            <div class="status-value" style="background-color: #E6F7F4; border-left: 4px solid #2A9D8F;">4%</div>
            <div class="status-value" style="background-color: #E6F7F4; border-left: 4px solid #2A9D8F;">3%</div>
          </div>
          <div class="status-row">
            <div class="status-category">Inactif</div>
            <div class="status-value" style="background-color: #F9E9EC; border-left: 4px solid #A77A82;">0%</div>
            <div class="status-value" style="background-color: #F9E9EC; border-left: 4px solid #A77A82;">4%</div>
            <div class="status-value" style="background-color: #F9E9EC; border-left: 4px solid #A77A82;">2%</div>
            <div class="status-value" style="background-color: #F9E9EC; border-left: 4px solid #A77A82;">2%</div>
          </div>
          <div class="status-row">
            <div class="status-category">Non r√©pondant</div>
            <div class="status-value" style="background-color: #e9e9f9; border-left: 4px solid #7d7aa7;">0%</div>
            <div class="status-value" style="background-color: #e9e9f9; border-left: 4px solid #7d7aa7;">4%</div>
            <div class="status-value" style="background-color: #e9e9f9; border-left: 4px solid #7d7aa7;">15%</div>
            <div class="status-value" style="background-color: #e9e9f9; border-left: 4px solid #7d7aa7;">19%</div>
          </div>
        </div>

        <!-- <button style="margin-top: 60px;" class="analysis-toggle"
          onclick="toggleAnalysis('chart2-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart2-analysis" class="analysis-content"
          style=" margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333;">
          <h4 style="color: #15616D; margin: 30px 0 10px;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p>Ce widget suit l‚Äô√©volution de la situation des dipl√¥m√©s : emploi, recherche, √©tudes et inactivit√©.
          </p>
          <p>Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et montre :</p>
          <ul style="padding-left: 20px;">
            <li><strong>Insertion rapide dans l‚Äôemploi :</strong> majorit√© en emploi d√®s l‚ÄôES2 (105 √† l‚ÄôES2, stable √† 95
              pour les ES3/ES4).</li>
            <li><strong>Forte baisse de la recherche d‚Äôemploi :</strong> de 140 √† l‚ÄôES1 √† seulement 4 √† l‚ÄôES4.</li>
            <li><strong>Poursuite d‚Äô√©tudes tr√®s faible :</strong> entre 4 et 5 √©tudiants concern√©s par vague.</li>
            <li><strong>Inactivit√© marginale :</strong> tr√®s peu de cas (maximum 5 √† l‚ÄôES2).</li>
            <li><strong>Stabilit√© des r√©ponses :</strong> l√©g√®re hausse des non-r√©ponses, mais donn√©es globalement
              fiables.</li>
          </ul>

          <h4 style="color: #15616D; margin: 30px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>Insertion rapide dans l‚Äôemploi :</strong> D√®s l‚ÄôES2, la majorit√© des r√©pondants sont en emploi
              (105 √† l‚ÄôES2, stable √† 95 pour les ES3 et ES4).</li>
            <li><strong>Diminution forte de la recherche d‚Äôemploi :</strong> De 140 √† l‚ÄôES1 √† seulement 4 √† l‚ÄôES4.</li>
            <li><strong>Tr√®s faible poursuite d‚Äô√©tudes :</strong> Entre 4 et 5 √©tudiants poursuivent leurs √©tudes √†
              chaque enqu√™te.</li>
            <li><strong>Inactivit√© marginale :</strong> Cas d‚Äôinactivit√© rares, maximum 5 √† l‚ÄôES2.</li>
            <li><strong>Bonne stabilit√© des r√©ponses :</strong> L√©g√®re hausse des non-r√©ponses mais donn√©es globalement
              fiables pour l‚Äôanalyse.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>Mettre en avant les bons taux d‚Äôemploi :</strong> Utiliser des formules comme ‚ÄúPlus de 90 % des
              r√©pondants en emploi‚Äù.</li>
            <li><strong>Montrer clairement l‚Äô√©volution :</strong> Visualiser la baisse du nombre de chercheurs d‚Äôemploi
              et la stabilit√© des emplois entre ES2 et ES4.</li>
            <li><strong>Tableaux de bord segment√©s :</strong> Ajouter des filtres par profil d√©mographique ou acad√©mique
              pour une analyse fine.</li>
            <li><strong>Accompagner les derniers chercheurs :</strong> D√©velopper des services cibl√©s pour les rares
              encore en recherche √† l‚ÄôES4.</li>
            <li><strong>R√©duire les non-r√©ponses :</strong> Renforcer les relances pour limiter les absences de r√©ponse
              dans les prochaines vagues.</li>
          </ol>
        </div>
      </div>


      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Situation Professionnelle √† 6 mois apr√®s la certification</h3><br>
        <div id="pieChartStatut" class="chart-container" style="height: 300px;"></div>
        <!-- <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2">(A) A un emploi <span
                style="color: #67b7dc; font-size: 16px"><strong>33%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2">(B) Recherche <span
                style="color: #6794dc; font-size: 16px"><strong>6%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6771dc;"></span>
            <span class="legend-label2">(C) Poursuit des √©tudes <span
                style="color: #6771dc; font-size: 16px"><strong>57%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #8067dc;"></span>
            <span class="legend-label2">(D) Inactif <span
                style="color: #8067dc; font-size: 16px"><strong>2%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2">(E) Non r√©pondant <span
                style="color: #a367dc; font-size: 16px"><strong>2%</strong></span></span>
          </div>
        </div> -->
      </div>
    </div>

    <hr style="border: none; border-top: 5px solid #D0E6E6; margin: 30px 0 10px 0;">

    <h2 style="color:#15616D; margin-bottom: 20px;">Global</h2>
    <div class="grid2" style="margin-bottom: 20px;">
      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3
          style="text-align: left; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D; margin-bottom: 10px;">
          <strong>Postes</strong>
        </h3>
        <p style="color: #1E9180 "><strong>Postes cibl√©s apr√®s 24 mois :<span style="color:#49928a;"> 75%
            </span></strong></p>
        <table style="margin: 0 auto; text-align: center;">
          <thead>
            <tr style="font-size: 15px;">
              <th style="padding-left: 15px;">EE1</th>
              <th style="padding-left: 15px;">EE2</th>
              <th style="padding-left: 15px;">EE3</th>
              <th style="padding-left: 15px;">EE4</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-size: 13px; color: #159E8E;">
              <td style="padding-left: 15px; font-weight: 700;">0%</td>
              <td style="padding-left: 15px; font-weight: 700;">74%</td>
              <td style="padding-left: 15px; font-weight: 700;">82%</td>
              <td style="padding-left: 15px; font-weight: 700;">75%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3
          style="text-align: left; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D; margin-bottom: 10px;">
          <strong>Domaines</strong>
        </h3>
        <p style="color: #1E9180 "><strong>Domaines cibl√©s apr√®s 24 mois :<span style="color:#49928a;"> 97%
            </span></strong></p>
        <table style="margin: 0 auto; text-align: center;">
          <thead>
            <tr style="font-size: 15px;">
              <th style="padding-left: 15px;">EE1</th>
              <th style="padding-left: 15px;">EE2</th>
              <th style="padding-left: 15px;">EE3</th>
              <th style="padding-left: 15px;">EE4</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-size: 13px; color: #159E8E">
              <td style="padding-left: 15px; font-weight: 700;">0%</td>
              <td style="padding-left: 15px; font-weight: 700;">71%</td>
              <td style="padding-left: 15px; font-weight: 700;">85%</td>
              <td style="padding-left: 15px; font-weight: 700;">97%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3
          style="text-align: left; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D; margin-bottom: 10px;">
          <strong>Salaires</strong>
        </h3>
        <p style="color: #1E9180"><strong>Salaires cibl√©s apr√®s 24 mois :<span style="color:#49928a;"> 5%
            </span></strong></p>
        <table style="margin: 0 auto; text-align: center;">
          <thead>
            <tr style="font-size: 15px;">
              <th style="padding-left: 15px;">EE1</th>
              <th style="padding-left: 15px;">EE2</th>
              <th style="padding-left: 15px;">EE3</th>
              <th style="padding-left: 15px;">EE4</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-size: 13px; color: #159E8E">
              <td style="padding-left: 15px; font-weight: 700;">0%</td>
              <td style="padding-left: 15px; font-weight: 700;">5%</td>
              <td style="padding-left: 15px; font-weight: 700;">4%</td>
              <td style="padding-left: 15px; font-weight: 700;">5%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart-final-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3
          style="text-align: left; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D; margin-bottom: 10px;">
          <strong>Comp√©tences</strong>
        </h3>

        <!-- Optional: Show a placeholder or small summary -->
        <p style="text-align: center; color: #1E9180; font-weight: 500;"><span><strong>60%</strong></span> des
          comp√©tences cibl√©es sont utlis√©es.</p>
        <table style="margin: 0 auto; text-align: center;">
          <thead>
            <tr style="font-size: 15px;">
              <th style="padding-left: 15px;">EE1</th>
              <th style="padding-left: 15px;">EE2</th>
              <th style="padding-left: 15px;">EE3</th>
              <th style="padding-left: 15px;">EE4</th>
            </tr>
          </thead>
          <tbody>
            <tr style="font-size: 13px; color: #159E8E">
              <td style="padding-left: 15px; font-weight: 700;">0%</td>
              <td style="padding-left: 15px; font-weight: 700;">54%</td>
              <td style="padding-left: 15px; font-weight: 700;">63%</td>
              <td style="padding-left: 15px; font-weight: 700;">60%</td>
            </tr>
          </tbody>
        </table>
        <!-- <button class="analysis-toggle" onclick="toggleAnalysis('chart-final-analysis')"
          style="margin: 10px auto 0 auto; display: block;">Afficher/Masquer l‚Äôanalyse</button> -->

        <div id="chart-final-analysis" class="analysis-content"
          style="display: none; margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333; text-align: left;">

          <h4 style="color: #15616D; margin-bottom: 10px;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p>Ce widget pr√©sente les objectifs professionnels des dipl√¥m√©s 24 mois apr√®s la fin de leur formation, en
            mettant l‚Äôaccent sur les m√©tiers, les secteurs et les salaires vis√©s.</p>
          <p>Il s‚Äôappuie sur les donn√©es issues des enqu√™tes ES1 √† ES4, notamment :</p>
          <ul style="padding-left: 20px;">
            <li><strong>Postes cibl√©s :</strong> les dipl√¥m√©s visent majoritairement des m√©tiers √† forte valeur ajout√©e
              comme chef de projet, analyste data, consultant ou product owner.</li>
            <li><strong>Secteurs privil√©gi√©s :</strong> les domaines IT, finance, conseil et industrie dominent les
              intentions, en phase avec les tendances du march√©.</li>
            <li><strong>Salaires esp√©r√©s :</strong> la tranche <strong>1 900‚Ç¨ √† 2 199‚Ç¨</strong> est la plus vis√©e √†
              partir de l‚ÄôEE2, avec un pic de 17‚ÄØ% √† l‚ÄôEE3.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>Postes vis√©s :</strong> les dipl√¥m√©s ciblent des m√©tiers √† forte valeur ajout√©e tels que chef de
              projet, analyste data, consultant, ou product owner.</li>
            <li><strong>Secteurs dynamiques :</strong> IT, finance, conseil, et industrie dominent les intentions,
              montrant une bonne orientation vers des secteurs en croissance.</li>
            <li><strong>Salaires cibl√©s :</strong> une majorit√© vise la tranche <strong>1 900‚Ç¨ √† 2 199‚Ç¨</strong> √†
              partir d‚ÄôEE2, avec un pic √† 17% √† EE3.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandation</h4>
          <ol style="padding-left: 20px;">
            <li><span style="color: #2e7d32;"><strong>Aligner la formation</strong></span> avec les besoins du march√© en
              renfor√ßant les comp√©tences cl√©s des secteurs porteurs.</li>
            <li><span style="color: #2e7d32;"><strong>Renforcer le suivi post-formation</strong></span> (coaching,
              r√©seau, accompagnement) pour convertir les intentions en opportunit√©s concr√®tes.</li>
          </ol>
        </div>
      </div>
    </div>

    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3
          style="text-align: center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; font-size: 18px; font-weight: 600; color: #00454D; margin: 30px 0px 5px 0px">
          <strong>Fourchette salariale moyenne</strong>
        </h3>
        <p style="padding-top: 20px;"><strong>1 600‚Ç¨ ‚Äì 1 899‚Ç¨</strong></p>
        <p style="color:#49928a; padding-bottom: 25px; font-size: 20px;"><strong>39%</strong></p>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <div class="flex-content">
          <!-- <div class="flex-icon"> -->
          <!-- <svg style="fill:#1E9180" height="100" class="thumbs-up-icon" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
                    <path d="M320 1344q0-26-19-45t-45-19q-27 0-45.5 19t-18.5 45q0 27 18.5 45.5t45.5 18.5q26 0 45-18.5t19-45.5zm160-512v640q0 26-19 45t-45 19h-288q-26 0-45-19t-19-45v-640q0-26 19-45t45-19h288q26 0 45 19t19 45zm1184 0q0 86-55 149 15 44 15 76 3 76-43 137 17 56 0 117-15 57-54 94 9 112-49 181-64 76-197 78h-129q-66 0-144-15.5t-121.5-29-120.5-39.5q-123-43-158-44-26-1-45-19.5t-19-44.5v-641q0-25 18-43.5t43-20.5q24-2 76-59t101-121q68-87 101-120 18-18 31-48t17.5-48.5 13.5-60.5q7-39 12.5-61t19.5-52 34-50q19-19 45-19 46 0 82.5 10.5t60 26 40 40.5 24 45 12 50 5 45 .5 39q0 38-9.5 76t-19 60-27.5 56q-3 6-10 18t-11 22-8 24h277q78 0 135 57t57 135z" />
                </svg> -->
          <div id="pieChartSatisfaction" class="chart-container" style="height: 120px; width: 150px;">

          </div>
          <!-- </div> -->
          <div class="flex-text">
            <h3 class="title">Taux de satisfaction de la formation</h3>
            <p class="percentage">73%</p>
          </div>
        </div>

      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Effectif & Taux de succ√®s √† certification</h3>
        <div class="legend-item">
          <span class="legend-color" style="background-color: #8f8f8f;"></span>
          <span class="legend-label">Nombre total d'√©tudiants : <strong>383</strong></span>
        </div>
        <div id="pieChartA" class="chart-container" style="height: 300px; margin-top: 30px;"></div>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Distribution des enqu√™tes par vague</h3>
        <div id="chartSent" class="chart-container" style="height: 400px;"></div>
      </div>

      <div class="chart-box" style="text-align: center; position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart1-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Ouvert ‚Äì Commenc√© ‚Äì Enqu√™te compl√©t√©e (EE1‚ÄìEE4)</h3>
        <div id="chart1" class="chart-container"></div>
        <!-- <button class="analysis-toggle" onclick="toggleAnalysis('chart1-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart1-analysis" class="analysis-content"
          style="margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333;">
          <h4 style="color: #15616D; margin-bottom: 10px;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p>Ce widget suit l‚Äôengagement des dipl√¥m√©s aux enqu√™tes de suivi de l‚ÄôEE1 √† l‚ÄôEE4.</p>
          <p>Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et montre :</p>
          <ul style="padding-left: 20px;">
            <li><strong>Moins d‚Äôenvois dans le temps,</strong> car seuls les dipl√¥m√©s sans poursuite d‚Äô√©tudes re√ßoivent
              les vagues suivantes.</li>
            <li><strong>Taux de participation √©lev√©s</strong> chez les r√©pondants (97‚ÄØ% √† EE2, 98‚ÄØ% √† EE3, 96‚ÄØ% √† EE4).
            </li>
            <li><strong>L√©g√®re baisse des ouvertures</strong> malgr√© une bonne d√©livrabilit√©.</li>
            <li><strong>EE1 est un cas √† part,</strong> envoy√©e √† tous les dipl√¥m√©s juste apr√®s la fin des √©tudes, d‚Äôo√π
              son taux √©lev√© de r√©ponse.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>Chute progressive des envois li√©e √† la logique de ciblage :</strong> le volume d‚Äôe-mails diminue
              m√©caniquement √† chaque vague (de 318 √† 131) car seuls les anciens ayant d√©clar√© ne pas poursuivre leurs
              √©tudes re√ßoivent les vagues suivantes.</li>
            <li><strong>Participation √©lev√©e chez les r√©pondants √©ligibles :</strong> malgr√© la baisse du volume, ceux
              qui re√ßoivent le questionnaire restent majoritairement actifs (taux de compl√©tion de 97‚ÄØ% √† l‚ÄôEE2, 98‚ÄØ% √†
              l‚ÄôEE3, 96‚ÄØ% √† l‚ÄôEE4).</li>
            <li><strong>L√©g√®re baisse de l‚Äôouverture :</strong> bien que les e-mails soient bien d√©livr√©s (108
              ouvertures pour 131 envois √† l‚ÄôEE4), un l√©ger d√©sengagement appara√Æt avec le temps.</li>
            <li><strong>EE1 reste un cas √† part :</strong> envoy√©e √† tous les dipl√¥m√©s, cette vague b√©n√©ficie d‚Äôun
              contexte tr√®s favorable (fin d‚Äô√©tudes), expliquant son taux maximal de r√©ponse.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>Clarifier la logique de suivi aux r√©pondants :</strong> d√®s l‚ÄôEE1, expliquer qu‚Äôun suivi sera
              r√©alis√© pour ceux qui ne poursuivent pas d‚Äô√©tudes, afin d‚Äôaugmenter la disponibilit√© aux vagues suivantes.
            </li>
            <li><strong>Segmenter finement les messages selon les profils</strong> : personnaliser selon le parcours
              (ex. : ‚ÄúComment va votre recherche d‚Äôemploi ?‚Äù vs. ‚ÄúVous nous manquez !‚Äù).</li>
            <li><strong>Renforcer les relances cibl√©es</strong> : planifier 2 √† 3 rappels avec des objets d‚Äôe-mail
              vari√©s et des messages dynamiques.</li>
            <li><strong>Simplifier encore le questionnaire</strong> : viser une dur√©e inf√©rieure √† 3 minutes, en
              particulier pour les vagues EE3/EE4 o√π l‚Äôattention peut baisser.</li>
            <li><strong>Valoriser la contribution des r√©pondants</strong> : mise en avant dans une newsletter,
              certificat, ou loterie pour remercier la fid√©lit√© des anciens.</li>
            <li><strong>Optimiser le format mobile</strong> : v√©rifier que tous les supports (e-mails et formulaires)
              soient 100‚ÄØ% adapt√©s aux smartphones.</li>
            <li><strong>Mobiliser des ambassadeurs</strong> : int√©grer des t√©moignages ou vid√©os d‚Äôanciens √©l√®ves ou
              enseignants pour renforcer la motivation √† r√©pondre.</li>
          </ol>
        </div>
      </div>
    </div>

    <hr style="border: none; border-top: 5px solid #D0E6E6; margin: 30px 0 10px 0;">

    <h2 style="color:#15616D; margin-bottom: 20px;">Comp√©tences</h2>
    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 id="chartSkillTarget-title">Les 5 principales comp√©tences utilis√©es dans les emplois cibl√©s</h3>
        <div id="chartSkillTarget" class="chart-container"></div>
        <!-- <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(A) Participation in the definition of commercial
              objectives <span style="color: #67b7dc; font-size: 14px"><strong>10%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(B) Implementation of sales support tools <span
                style="color: #6794dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6771dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(C) Analysis of performance indicators <span
                style="color: #6771dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #8067dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(D) Identification of business development
              opportunities
              <span style="color: #8067dc; font-size: 14px"><strong>8%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(E) Participation in the development of individual and
              collective objectives <span style="color: #a367dc; font-size: 14px"><strong>8%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(F) Autre <span
                style="color: #a367dc; font-size: 14px"><strong>56%</strong></span></span>
          </div>
        </div> -->
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 id="chartSkillNonTarget-title">Les 5 principales comp√©tences utilis√©es dans les emplois non cibl√©s</h3>
        <div id="chartSkillNonTarget" class="chart-container"></div>
        <!-- <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(A) Participation in the definition of commercial
              objectives <span style="color: #67b7dc; font-size: 14px"><strong>10%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(B) Definition of performance indicators for commercial
              policy <span style="color: #6794dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6771dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(C) Implementation of sales support tools <span
                style="color: #6771dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #8067dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(D) Participation in the development of individual and
              collective objectives <span style="color: #8067dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(E) Development of dashboards <span
                style="color: #a367dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(F) Autre <span
                style="color: #a367dc; font-size: 14px"><strong>54%</strong></span></span>
          </div>
        </div> -->
      </div>
    </div>

    <hr style="border: none; border-top: 5px solid #D0E6E6; margin: 30px 0 10px 0;">

    <h2 style="color:#15616D; margin-bottom: 20px;">Emploi</h2>
    <div class="grid" style="margin-bottom: 20px;">

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" onclick="openModalJobTargeted()" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="openModalScopeEmploi()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3><strong>Emplois cibl√©s apr√®s 6 mois</strong>
        </h3>
        <div id="pieChart" style="width: 100%; height: 270px; margin: auto;"></div>
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3><strong>Les 3 principaux domaines</strong>
        </h3>
        <div id="domainePieChart" style="width: 100%; height: 270px; margin: auto;"></div>
      </div>

    </div>

    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 id="chartSizeTarget-title">Taille de l'entreprise dans les emplois cibl√©s</h3>
        <div id="chartSizeTarget" class="chart-container"></div>
        <!-- <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(A) Tr√®s petite entreprise : 1 √† 9 <span
                style="color: #67b7dc; font-size: 14px"><strong>27%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(B) Moyenne entreprise : 50 √† 499 <span
                style="color: #6794dc; font-size: 14px"><strong>24%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6771dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(C) Petite entreprise : 10 √† 49 <span
                style="color: #6771dc; font-size: 14px"><strong>17%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #8067dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(D) Tr√®s grande entreprise : 1000 et + <span
                style="color: #8067dc; font-size: 14px"><strong>18%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(E) Grande entreprise : 500 √† 999 <span
                style="color: #a367dc; font-size: 14px"><strong>7%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(F) Micro entreprise : 0 <span
                style="color: #a367dc; font-size: 14px"><strong>7%</strong></span></span>
          </div>
        </div> -->
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 id="chartSizeNonTarget-title">Taille de l'entreprise dans les emplois non cibl√©s</h3>
        <div id="chartSizeNonTarget" class="chart-container"></div>
        <!-- <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(A) Tr√®s petite entreprise : 1 √† 9 <span
                style="color: #67b7dc; font-size: 14px"><strong>18%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(B) Moyenne entreprise : 50 √† 499 <span
                style="color: #6794dc; font-size: 14px"><strong>18%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6771dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(C) Petite entreprise : 10 √† 49 <span
                style="color: #6771dc; font-size: 14px"><strong>32%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #8067dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(D) Tr√®s grande entreprise : 1000 et + <span
                style="color: #8067dc; font-size: 14px"><strong>13%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(E) Grande entreprise : 500 √† 999 <span
                style="color: #a367dc; font-size: 14px"><strong>10%</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #a367dc;"></span>
            <span class="legend-label2" style="font-size: 13px;">(F) Micro entreprise : 0 <span
                style="color: #a367dc; font-size: 14px"><strong>9%</strong></span></span>
          </div>
        </div> -->
      </div>
    </div>

    <div class="grid" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart6-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 id="chart6-title">Les 8 premi√®res entreprises</h3>
        <div class="tabs">
          <button class="tab-button6" data-tab="EE1">EE1</button>
          <button class="tab-button6 active" data-tab="EE2">EE2</button>
          <button class="tab-button6" data-tab="EE3">EE3</button>
          <button class="tab-button6" data-tab="EE4">EE4</button>
        </div>
        <div id="chart6" class="chart-container"></div>
        <!-- <button class="analysis-toggle" onclick="toggleAnalysis('chart6-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart6-analysis" class="analysis-content">
          <h4 style="color: #15616D; margin: 30px 0 10px;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p>Ce widget pr√©sente les principaux employeurs des dipl√¥m√©s selon les r√©ponses aux enqu√™tes de l‚ÄôEE1 √† l‚ÄôEE4.
          </p>
          <p>Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et met en avant :</p>
          <ul style="padding-left: 20px;">
            <li><strong>Employeurs r√©currents</strong> comme Decathlon, Orange et Soci√©t√© G√©n√©rale visibles dans toutes
              les vagues.</li>
            <li><strong>Secteurs dominants :</strong> distribution et banque/assurance (ex. : Carrefour, AXA).</li>
            <li><strong>Cat√©gorie ‚ÄúAutre‚Äù importante,</strong> montrant de nombreux recrutements hors du top 8.</li>
            <li><strong>Pr√©sence r√©guli√®re,</strong> signe de relations solides ou d‚Äôun int√©r√™t r√©current pour les
              profils dipl√¥m√©s.</li>
          </ul>

          <h4 style="color: #15616D; margin: 30px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>D√©cathlon, Orange, Soci√©t√© G√©n√©rale :</strong> Employeurs r√©currents visibles dans toutes les
              vagues.</li>
            <li><strong>Secteurs forts :</strong> Distribution et banque/assurance (Carrefour, AXA, Soci√©t√© G√©n√©rale).
            </li>
            <li><strong>Cat√©gorie ‚ÄúAutre‚Äù importante :</strong> Beaucoup de dipl√¥m√©s en dehors du top 8 entreprises.
            </li>
            <li><strong>Pr√©sence r√©guli√®re d‚Äôemployeurs :</strong> Indice de relations fortes ou d‚Äôint√©r√™t r√©current
              pour le profil dipl√¥m√©.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>Renforcer les relations entreprises :</strong> Avec les groupes majeurs (ex : AXA, Orange,
              Decathlon).</li>
            <li><strong>Explorer les recruteurs ‚ÄúAutres‚Äù :</strong> Mieux comprendre et identifier ces structures.</li>
            <li><strong>Mettre en valeur les employeurs partenaires :</strong> Dans les communications
              institutionnelles.</li>
            <li><strong>Segmenter les entreprises :</strong> Pour mieux cibler l'accompagnement par secteur.</li>
          </ol>
        </div>
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <!-- <button class="info-button secondary" onclick="openModalScopeManagerial()" title="Scope"> -->
          <button class="info-button secondary" onclick="toggleAnalysis('chart4-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>Niveau manag√©rial</h3>
        <div class="manual-legend">
          <div class="legend-item">
            <span class="legend-color" style="background-color: #2A9D8F;"></span>
            <span class="legend-label">Ayant un poste de Manager</span>
          </div>
        </div>
        <div id="chart4" style="width: 100%; height: 450px;"></div>

        <!-- <button style="margin-top: 40px;" class="analysis-toggle"
          onclick="toggleAnalysis('chart4-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart4-analysis" class="analysis-content"
          style="margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333;">
          <h4 style="color: #15616D; margin: 30px 0 10px;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p>Ce widget pr√©sente la progression professionnelle des dipl√¥m√©s vers des postes de management au fil du
            temps.
          </p>
          <p>Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et montre :</p>
          <ul style="padding-left: 20px;">
            <li><strong>Nombre croissant de managers :</strong> de 20 √† 30 entre l‚ÄôEE2 et l‚ÄôEE4.</li>
            <li><strong>Progression constante :</strong> environ +5 nouveaux managers √† chaque vague.</li>
            <li><strong>Encore minoritaire :</strong> environ 25‚ÄØ% seulement sont managers √† l‚ÄôEE4.</li>
            <li><strong>Mobilit√© ascendante :</strong> le programme semble favoriser l‚Äô√©volution de carri√®re √† long
              terme.</li>
          </ul>

          <h4 style="color: #15616D; margin: 30px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>Nombre croissant de managers :</strong> de 20 √† 30 entre EE2 et EE4.</li>
            <li><strong>Progression constante :</strong> environ +5 √† chaque vague.</li>
            <li><strong>Encore une minorit√© :</strong> seulement 25 % environ sont managers √† EE4.</li>
            <li><strong>Mobilit√© ascendante :</strong> le programme semble favoriser l‚Äô√©volution de carri√®re.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>Partager des parcours inspirants :</strong> anciens √©l√®ves devenus managers.</li>
            <li><strong>Mettre en avant la progression :</strong> sous forme graphique ou comparative.</li>
            <li><strong>Offrir un accompagnement au leadership :</strong> coaching, mentorat ou formations.</li>
            <li><strong>Utiliser dans la communication :</strong> pour d√©montrer l‚Äôimpact long terme du dipl√¥me.</li>
          </ol>
        </div>

      </div>
    </div>


    <div class="grid">
      <div class="chart-box" style="position: relative;">

        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart3-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <br>
        <h3>Type de contrat</h3>
        <div id="chart3" class="chart-container"></div>
        <!-- <button class="analysis-toggle" onclick="toggleAnalysis('chart3-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart3-analysis" class="analysis-content"
          style="margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333;">
          <h4 style="color: #15616D; margin: 30px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>CDI largement dominant :</strong> Plus de 60 dipl√¥m√©s par vague sont en contrat stable.</li>
            <li><strong>CDD et int√©rim peu pr√©sents :</strong> Ce qui montre une insertion rapide et s√©curis√©e.</li>
            <li><strong>L‚Äôauto-entrepreneuriat reste solide :</strong> Environ 15 r√©pondants en EE2‚ÄìEE3.</li>
            <li><strong>Carri√®res vari√©es :</strong> Fonctionnaire, g√©rant, ind√©pendant ‚Äî diversit√© des choix.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>Mettre en avant les CDI :</strong> T√©moignages d‚Äôalumni, donn√©es chiffr√©es.</li>
            <li><strong>Accompagner les entrepreneurs :</strong> Coaching, incubateurs, mise en r√©seau.</li>
            <li><strong>√âtudier la baisse de l‚Äôint√©rim :</strong> Pour mieux comprendre la tendance.</li>
            <li><strong>Segmenter les services :</strong> Salari√©s vs ind√©pendants = besoins diff√©rents.</li>
          </ol>
        </div>

      </div>



      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="toggleAnalysis('chart5-analysis')" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <br>
        <h3>Top 8 fonctions</h3>
        <div id="chart5" class="chart-container"></div>
        <!-- <button class="analysis-toggle" onclick="toggleAnalysis('chart5-analysis')">Afficher/Masquer l‚Äôanalyse</button> -->
        <div id="chart5-analysis" class="analysis-content"
          style="margin-top: 20px; font-size: 15px; line-height: 1.6; color: #333;">
          <h4 style="color: #15616D; margin: 30px 0 10px;">üîç Analyse</h4>
          <ul style="padding-left: 20px;">
            <li><strong>Les fonctions commerciales dominent :</strong> Conseiller commercial, Commercial, Responsable
              des ventes sont les plus fr√©quentes.</li>
            <li><strong>Les postes marketing sont rares :</strong> Tr√®s peu de ‚ÄúResponsable marketing‚Äù, ‚ÄúChef de
              produit‚Äù, etc.</li>
            <li><strong>La cat√©gorie ‚ÄúAutre‚Äù est surutilis√©e :</strong> 48 r√©ponses en EE2 et EE4 la rendent difficile √†
              exploiter.</li>
            <li><strong>Peu de changements dans le temps :</strong> La structure des r√¥les reste stable entre EE2 et
              EE4.</li>
          </ul>

          <h4 style="color: #15616D; margin: 20px 0 10px;">üõ†Ô∏è Recommandations</h4>
          <ol style="padding-left: 20px;">
            <li><strong>R√©viser les intitul√©s de poste :</strong> Inclure les r√¥les fr√©quents class√©s dans ‚ÄúAutre‚Äù.</li>
            <li><strong>Mettre en avant les r√¥les cl√©s :</strong> Aide √† l‚Äôorientation des futurs dipl√¥m√©s.</li>
            <li><strong>Analyser les r√¥les ‚ÄúAutre‚Äù :</strong> Ajouter un champ libre pour recueillir ces intitul√©s.</li>
            <li><strong>Adapter les services carri√®re :</strong> Se concentrer sur les postes r√©ellement occup√©s par les
              alumni.</li>
          </ol>
        </div>

      </div>
    </div>

    <hr style="border: none; border-top: 5px solid #D0E6E6; margin: 30px 0 10px 0;">

    <h2 style="color:#15616D; margin-bottom: 20px;">Parcours</h2>
    <div class="grid4" style="margin-bottom: 20px;">

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3>√âvolution du statut professionnel de l‚Äô√©tudiant</h3>
        <div id="chartdivSankee"></div>
      </div>
    </div>

    <hr style="border: none; border-top: 5px solid #D0E6E6; margin: 30px 0 10px 0;">

    <h2 style="color:#15616D; margin-bottom: 20px;">Demographique</h2>
    <div class="grid0" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 style="text-align: center; font-size: 24px;">√âtudiants par r√©gion</h3><br>
        <div id="container" style="display: flex; align-items: flex-start; gap: 20px;">
          <div id="studentsLegend" style="width: 350px;"></div>
          <div id="studentsChart" style="flex-grow: 1; height: 450px;"></div>
        </div>
      </div>

      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 style="text-align: center; font-size: 24px;">R√©partition par genre</h3><br>
        <!-- <div class="legend-item">
          <span class="legend-color" style="background-color: #67b7dc;"></span>
          <span class="legend-label">Homme <span style="color: #67b7dc"><strong>44%</strong></span></span>
        </div>
        <div class="legend-item">
          <span class="legend-color" style="background-color: #6794dc;"></span>
          <span class="legend-label">Femme <span style="color: #6794dc"><strong>56%</strong></span></span>
        </div> -->
        <div id="pieChartGender" class="chart-container" style="height: 400px;"></div>
        <div class="manual-legend2">
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #6794dc;"></span>
            <span class="legend-label2">Femme <span
                style="color: #6794dc; font-size: 16px"><strong>(56%)</strong></span></span>
          </div>
          <div class="legend-item2">
            <span class="legend-color2" style="background-color: #67b7dc;"></span>
            <span class="legend-label2">Homme <span
                style="color: #67b7dc; font-size: 16px"><strong>(44%)</strong></span></span>
          </div>
        </div>
      </div>
    </div>

    <div class="grid4" style="margin-bottom: 20px;">
      <div class="chart-box" style="position: relative;">
        <div class="button-container">
          <button class="info-button" title="Information">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/paragraph.png " alt="Info">
          </button>
          <button class="info-button primary"
            onclick="window.open(`https://docs.google.com/spreadsheets/d/16Ob9SgV4pd171NAXZaZh6hrTec-CWxsf8ifmaRqMewE/edit?gid=892605651#gid=892605651`, '_blank')"
            title="Export">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/excel.png" alt="Download">
          </button>
          <button class="info-button secondary" onclick="downloadChart()" title="Scope">
            <img src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644048.png"
              alt="Download">
          </button>
        </div>
        <h3 style="text-align: center; font-size: 24px;">Salaire moyen par r√©gion (‚Ç¨)</h3><br>
        <div id="containerSalary" style="display: flex; align-items: flex-start; gap: 20px;">
          <div id="salaryLegend" style="width: 400px;"></div>
          <div id="salaryChart" style="flex-grow: 1; height: 500px;"></div>
        </div>
      </div>
    </div>

    <!-- MODAL -->
    <div id="infoModal" class="modal" onclick="closeModal(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <button class="close-button" onclick="closeModal()">
          <!-- Close Icon SVG -->
          <svg viewBox="0 0 24 24">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>

        <div class="detailed-chart">
          <h2>Poursuite d‚Äô√©tude √† 6 mois apr√®s la certification</h2>
          <h4 style="color: #15616D; margin: 30px 0 10px; text-align: left;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p style="text-align: left; color:#0E3F2D">Ce widget suit l‚Äô√©volution de la situation des dipl√¥m√©s : emploi,
            recherche, √©tudes et inactivit√©.
          </p>
          <p style="text-align: left; color:#0E3F2D">Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et montre :</p>
          <ul style="padding-left: 20px; text-align: left; color:#0E3F2D">
            <li style="text-align: left; color:#0E3F2D"><strong>Insertion rapide dans l‚Äôemploi :</strong> majorit√© en
              emploi d√®s l‚ÄôES2 (105 √† l‚ÄôES2, stable √† 95
              pour les ES3/ES4).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Forte baisse de la recherche d‚Äôemploi :</strong> de 140
              √† l‚ÄôES1 √† seulement 4 √† l‚ÄôES4.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Poursuite d‚Äô√©tudes tr√®s faible :</strong> entre 4 et 5
              √©tudiants concern√©s par vague.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Inactivit√© marginale :</strong> tr√®s peu de cas (maximum
              5 √† l‚ÄôES2).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Stabilit√© des r√©ponses :</strong> l√©g√®re hausse des
              non-r√©ponses, mais donn√©es globalement
              fiables.</li>
          </ul>
          <div id="previewContinueStudyBar" class="chart-container"></div>
        </div>
      </div>
    </div>

    <div id="infoModalScope" class="modal" onclick="closeModalScope(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <button class="close-button" onclick="closeModalScope()">
          <!-- Close Icon SVG -->
          <svg viewBox="0 0 24 24">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>

        <div class="detailed-chart">
          <h2>Poursuite d‚Äô√©tude √† 6 mois apr√®s la certification</h2>
          <h4 style="color: #15616D; margin: 30px 0 10px; text-align: left;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p style="text-align: left; color:#0E3F2D">Ce widget suit l‚Äô√©volution de la situation des dipl√¥m√©s : emploi,
            recherche, √©tudes et inactivit√©.
          </p>
          <p style="text-align: left; color:#0E3F2D">Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES2, et montre :</p>
          <ul style="padding-left: 20px; text-align: left; color:#0E3F2D; padding-bottom: 30px;">
            <li style="text-align: left; color:#0E3F2D"><strong>Insertion rapide dans l‚Äôemploi :</strong> majorit√© en
              emploi d√®s l‚ÄôES2 (105 √† l‚ÄôES2, stable √† 95
              pour les ES3/ES2).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Forte baisse de la recherche d‚Äôemploi :</strong> de 140
              √† l‚ÄôES1 √† seulement 4 √† l‚ÄôES2.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Poursuite d‚Äô√©tudes tr√®s faible :</strong> entre 4 et 5
              √©tudiants concern√©s par vague.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Inactivit√© marginale :</strong> tr√®s peu de cas (maximum
              5 √† l‚ÄôES2).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Stabilit√© des r√©ponses :</strong> l√©g√®re hausse des
              non-r√©ponses, mais donn√©es globalement
              fiables.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="infoModalScopeManagerial" class="modal" onclick="closeModalScopeManagerial(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <button class="close-button" onclick="closeModalScopeManagerial()">
          <!-- Close Icon SVG -->
          <svg viewBox="0 0 24 24">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>

        <div class="detailed-chart">
          <h2>Niveau manag√©rial</h2>
          <h4 style="color: #15616D; margin: 30px 0 10px; text-align: left;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p style="text-align: left; color:#0E3F2D">Ce widget pr√©sente la progression professionnelle des dipl√¥m√©s vers
            des postes de management au fil du
            temps.
          </p>
          <p style="text-align: left; color:#0E3F2D">Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES4, et montre :</p>
          <ul style="padding-left: 20px; text-align: left; color:#0E3F2D; padding-bottom: 30px;">
            <li style="text-align: left; color:#0E3F2D"><strong>Nombre croissant de managers :</strong> de 20 √† 30 entre
              l‚ÄôEE2 et l‚ÄôEE4.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Progression constante :</strong> environ +5 nouveaux
              managers √† chaque vague.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Encore minoritaire :</strong> environ 25‚ÄØ% seulement
              sont managers √† l‚ÄôEE4.</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Mobilit√© ascendante :</strong> le programme semble
              favoriser l‚Äô√©volution de carri√®re √† long
              terme.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="infoModalScopeEmploi" class="modal" onclick="closeModalScopeEmploi(event)">
      <div class="modal-content" onclick="event.stopPropagation()">
        <button class="close-button" onclick="closeModalScopeEmploi()">
          <!-- Close Icon SVG -->
          <svg viewBox="0 0 24 24">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>

        <div class="detailed-chart">
          <h2>Emplois cibl√©s apr√®s 6 mois</h2>
          <h4 style="color: #15616D; margin: 30px 0 10px; text-align: left;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p style="text-align: left; color:#0E3F2D">Ce widget montre la r√©partition des postes vis√©s ou non vis√©s dans
            le secteur commercial, selon les premi√®res tendances d‚Äôinsertion.
          </p>
          <p style="text-align: left; color:#0E3F2D">Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES2, et met en avant
            :</p>
          <ul style="padding-left: 20px; text-align: left; color:#0E3F2D; padding-bottom: 30px;">
            <li style="text-align: left; color:#0E3F2D"><strong>Les fonctions commerciales dominent</strong> (40
              r√©pondants, 38‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Les postes non cibl√©s</strong> restent notables (27
              r√©pondants, 26‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Autres postes cibl√©s</strong> plus rares (9 r√©pondants,
              9‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Inactivit√© marginale :</strong> tr√®s peu de cas (maximum
              5 √† l‚ÄôES2).</li>
            <li style="text-align: left; color:#0E3F2D">Postes sp√©cifiques comme ‚ÄúResponsable commercial‚Äù (4 r√©pondants,
              4‚ÄØ%) et ‚ÄúConseiller commercial‚Äù (24 r√©pondants, 23‚ÄØ%) apparaissent r√©guli√®rement.</li>
          </ul>
        </div>
      </div>
    </div>

    <div id="infoModalJobTargeted" class="modal" onclick="closeModalJobTargeted(event)">
      <div class="modal-content" onclick="event.stopPropagationJobTargeted()">
        <button class="close-button" onclick="closeModalJobTargeted()">
          <!-- Close Icon SVG -->
          <svg viewBox="0 0 24 24">
            <path
              d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
          </svg>
        </button>

        <div class="detailed-chart">
          <h2>Emplois cibl√©s apr√®s 6 mois</h2>
          <h4 style="color: #15616D; margin: 30px 0 10px; text-align: left;"><img
              src="https://staging-sg-map-bucket.s3.ap-southeast-1.amazonaws.com/public/audience_4644238.png"
              style="width: 15px; height: 15px;"> Scope</h4>
          <p style="text-align: left; color:#0E3F2D">Ce widget montre la r√©partition des postes vis√©s ou non vis√©s dans
            le secteur commercial, selon les premi√®res tendances d‚Äôinsertion.
          </p>
          <p style="text-align: left; color:#0E3F2D">Il s‚Äôappuie sur les donn√©es des enqu√™tes ES1 √† ES2, et met en avant
            :</p>
          <ul style="padding-left: 20px; text-align: left; color:#0E3F2D; padding-bottom: 30px;">
            <li style="text-align: left; color:#0E3F2D"><strong>Les fonctions commerciales dominent</strong> (40
              r√©pondants, 38‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Les postes non cibl√©s</strong> restent notables (27
              r√©pondants, 26‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Autres postes cibl√©s</strong> plus rares (9 r√©pondants,
              9‚ÄØ%).</li>
            <li style="text-align: left; color:#0E3F2D"><strong>Inactivit√© marginale :</strong> tr√®s peu de cas (maximum
              5 √† l‚ÄôES2).</li>
            <li style="text-align: left; color:#0E3F2D">Postes sp√©cifiques comme ‚ÄúResponsable commercial‚Äù (4 r√©pondants,
              4‚ÄØ%) et ‚ÄúConseiller commercial‚Äù (24 r√©pondants, 23‚ÄØ%) apparaissent r√©guli√®rement.</li>
          </ul>
          <div id="previewJobTargeted" class="chart-container"></div>
        </div>
      </div>
    </div>

    <img style="padding-top: 50px;"
      src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzVweCIgaGVpZ2h0PSIyMXB4IiB2aWV3Qm94PSIwIDAgNzUgMjEiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjQgKDY3Mzc4KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5sb2dvPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IjAzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPgogICAgICAgIDxnIGlkPSIwMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTE4My4wMDAwMDAsIC0xNC4wMDAwMDApIiBzdHJva2Utd2lkdGg9IjIiPgogICAgICAgICAgICA8ZyBpZD0iSGVhZGVyIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJsb2dvIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxODQuMDAwMDAwLCAxNS4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8ZyBpZD0iYW1Mb2dvIj4KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcxLjYyMjY0MTUsMTkgTDQ1Ljk0MDI0NDIsMTkgQzMyLjQ1NDk5NDksMTguOTYzOTAxIDM0LjY0NDc5ODQsMCAyNC4wODEyNDQ1LDAgQzEzLjUxNzY5MDcsMCAxNS43MDc4MjQ4LDE4Ljk2MzkwMSAyLjM1Nzk5NDA5LDE5IEwtOC41NjU5MDI3NWUtMTQsMTkiIGlkPSJTdHJva2UtMSIgc3Ryb2tlPSIjNUVCMEZDIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDE5IEwyMS43NDQ2ODA5LDE5IEMyNS40MTcyNjIzLDE4Ljk3OTYzODggMjguMjk0ODI5MiwxOC4wNzI3NDI0IDMwLjkwMjA5MTgsMTQuOTM4NDI0NSBDMzIuMzk2MzEwOCwxMy4xNDIyMDE2IDMzLjcxMzkxMzEsMTEuMTYyMzk5IDM0Ljc2MzkwMDgsOS4wMTc0MDc2NyBDMzUuNjAzMDU0MSw3LjMwMjk1ODExIDM2LjA3MDc0NDcsNS4zMTU0MzggMzcuMTc1NTcwMiwzLjc2ODQ3NjEgQzM4LjAzNDQ0NzIsMi41NjU4NDkwOSAzOS45OTg0NDg2LDIuMzMwMDUyNzUgNDEuMDM0MDkxOCwzLjM3NzUwNzM4IEM0Mi43MjA0NjczLDUuMDgzNDE4MzUgNDMuMzMyOTQ3NywxMS4wODUyMjMzIDQ2LjA1MjcyNSwxMS4yNzk4MDQ2IEM0OC42MzQyODcxLDExLjQ2NDY5NzggNDkuMzg4NDE5NSw1LjUyMDY5MjQ4IDUwLjg5MTMwNDksMy43NzcxNzg4OCBDNTMuNjA2MTUxMywwLjYyODkwMzY4MiA1Ni4xMDY4NzYyLDQuMTI0MTQxMDUgNTcuMjAwMzQ1Niw2Ljg5MDMxNDUyIEM1OS42MTQxMDY5LDEyLjk5NjM4ODggNjMuODYwMjI5LDE4Ljk5OTgzNTggNzAuNjcwMjEyOCwxOC45OTk4MzU4IEw3MywxOC45OTk4MzY2IiBpZD0iUGFnZS0xIiBzdHJva2U9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIzLjQxNTA5NDMsMCBDMTMuMTY0NDMzNCwwIDE1LjI4OTU1MDksMTkuMDYxMzgxOSAyLjI2MzI1NTMxLDE4Ljk5OTg1MTQgTDEuMjQzNDQ5NzllLTEzLDE4Ljk5OTg1MTQiIGlkPSJTdHJva2UtMyIgc3Ryb2tlPSIjNUVCMEZDIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="
      alt="Nextera Logo">
  </main>

  <!-- Charts Initialization Scripts -->
  <script>
    am5.ready(function () {
      // Chart 1: Stacked Column Chart
      var root = am5.Root.new("chart1");
      root._logo.dispose();
      root.setThemes([am5themes_Animated.new(root)]);

      var chart = root.container.children.push(
        am5xy.XYChart.new(root, {
          panX: false,
          panY: false,
          wheelX: "none",
          wheelY: "none",
          layout: root.verticalLayout,
          paddingBottom: 50,
          paddingTop: 60, // Increased to accommodate the legend at the top
          paddingLeft: 15,
          paddingRight: 15
        })
      );

      var data = [
        { stage: "EE1", Sent: 318, Opened: 318, Started: 318, Completed: 318 },
        { stage: "EE2", Sent: 140, Opened: 134, Started: 134, Completed: 133 },
        { stage: "EE3", Sent: 136, Opened: 117, Started: 117, Completed: 115 },
        { stage: "EE4", Sent: 131, Opened: 108, Started: 108, Completed: 104 }
      ];

      // Create the legend and add it first (so it appears at the top)
      var legend = chart.children.push(
        am5.Legend.new(root, {
          centerX: am5.percent(50), // Center horizontally
          x: am5.percent(50),
          centerY: am5.percent(0), // Align to the top
          y: am5.percent(0),
          layout: am5.GridLayout.new(root, {
            maxColumns: 3, // Display items horizontally (3 columns)
            fixedWidthGrid: false
          }),
          paddingTop: 10,
          paddingBottom: 20
        })
      );

      legend.labels.template.setAll({
        fontSize: 16,
        fill: am5.color("#666666"),
        fontFamily: "Segoe UI"
      });

      legend.markers.template.setAll({
        width: 12,
        height: 12
      });

      var xRenderer = am5xy.AxisRendererX.new(root, {
        minGridDistance: 80,
        cellStartLocation: 0.2,
        cellEndLocation: 0.8,
        strokeOpacity: 0
      });

      xRenderer.labels.template.setAll({
        fontSize: 14,
        fill: am5.color("#666666"),
        fontFamily: "Segoe UI"
      });

      xRenderer.grid.template.set("visible", false);

      var xAxis = chart.xAxes.push(
        am5xy.CategoryAxis.new(root, {
          categoryField: "stage",
          renderer: xRenderer,
          tooltip: am5.Tooltip.new(root, {})
        })
      );
      xAxis.data.setAll(data);

      var yRenderer = am5xy.AxisRendererY.new(root, {
        strokeOpacity: 0
      });

      yRenderer.labels.template.setAll({
        fontSize: 14,
        fill: am5.color("#666666"),
        fontFamily: "Segoe UI"
      });

      yRenderer.grid.template.setAll({
        strokeOpacity: 0.1,
        stroke: am5.color("#A0A0A0")
      });

      var yAxis = chart.yAxes.push(
        am5xy.ValueAxis.new(root, {
          renderer: yRenderer,
          min: 0,
          max: 900
        })
      );

      function createSeries(name, field, color) {
        // Calculate totals for each stage
        let totals = {};
        data.forEach(item => {
          totals[item.stage] = (totals[item.stage] || 0) + item[field];
        });

        var series = chart.series.push(
          am5xy.ColumnSeries.new(root, {
            name: name,
            xAxis: xAxis,
            yAxis: yAxis,
            valueYField: field,
            categoryXField: "stage",
            clustered: true
          })
        );

        series.columns.template.setAll({
          width: am5.percent(85),
          fill: am5.color(color),
          stroke: am5.color(color),
          cornerRadiusTL: 3,
          cornerRadiusTR: 3
        });

        // Preprocess data to calculate accurate 100% percentages
        data.forEach(row => {
          let total = 318;

          if (row.stage === 'EE2') {
            total = 140;
          } else if (row.stage === 'EE3') {
            total = 136;
          } else if (row.stage === 'EE4') {
            total = 131;
          }

          const rawPercents = {
            Sent: total ? (row.Sent / total) * 100 : 0,
            Opened: total ? (row.Opened / total) * 100 : 0,
            Started: total ? (row.Started / total) * 100 : 0,
            Completed: total ? (row.Completed / total) * 100 : 0,
          };

          // Round down all values
          let rounded = {
            Sent: Math.floor(rawPercents.Sent),
            Opened: Math.floor(rawPercents.Opened),
            Started: Math.floor(rawPercents.Started),
            Completed: Math.floor(rawPercents.Completed)
          };

          let sum = rounded.Sent + rounded.Opened + rounded.Started + rounded.Completed;

          // Distribute remaining percentage to highest remainder
          let remainders = [
            { key: "Sent", value: rawPercents.Sent - rounded.Sent },
            { key: "Opened", value: rawPercents.Opened - rounded.Opened },
            { key: "Started", value: rawPercents.Started - rounded.Started },
            { key: "Completed", value: rawPercents.Completed - rounded.Completed }
          ];

          remainders.sort((a, b) => b.value - a.value); // Sort by biggest remainder

          let i = 0;
          while (sum < 100 && i < remainders.length) {
            rounded[remainders[i].key]++;
            sum++;
            i++;
          }

          // Attach to row
          row.SentPercent = rounded.Sent;
          row.OpenedPercent = rounded.Opened;
          row.StartedPercent = rounded.Started;
          row.CompletedPercent = rounded.Completed;
        });

        // Set dynamic tooltip with percentage
        series.columns.template.adapters.add("tooltipText", function (text, target) {
          const dataItem = target.dataItem.dataContext;
          let percentField = field + "Percent"; // e.g., "OpenedPercent"
          return `${name}: ${dataItem[field]} (${dataItem[percentField]}%)`;
        });

        series.columns.template.set("tooltip", am5.Tooltip.new(root, {
          pointerOrientation: "vertical",
          getFillFromSprite: true,
          getStrokeFromSprite: true,
          autoTextColor: true,
          paddingTop: 6,
          paddingBottom: 6,
          paddingLeft: 10,
          paddingRight: 10
        }));

        series.columns.template.states.create("hover", {
          fillOpacity: 0.8
        });

        // Conditionally add label bullet (skip for "Started" series)
        if (field !== "Opened") {
          series.bullets.push(function () {
            return am5.Bullet.new(root, {
              locationY: 1,
              sprite: am5.Label.new(root, {
                text: `{${field}Percent}%`, // e.g., "383 | 100%"
                centerY: am5.percent(0),
                centerX: am5.percent(50),
                dy: -30,
                populateText: true,
                fontSize: 13,
                fontWeight: "500",
                fill: am5.color("#333")
              })
            });
          });
        }

        series.data.setAll(data);
        series.appear();

        legend.data.push(series);
        return series;
      }

      createSeries("Envoy√©es", "Sent", "#8FD2D2");
      createSeries("Ouvertes", "Opened", "#4A90E2");
      // createSeries("Ouverture de l'enqu√™te", "Started", "#4A90E2");
      createSeries("Compl√©t√©es", "Completed", "#0E3F2D");

      chart.appear(1000, 100);


      // Chart 2: Donut/Ring Chart for Statut professionnel (with createSeries function)
      // Chart 2: Statut professionnel (4 Donut Charts EE1‚ÄìEE4)
      // const chart2Data = {
      //   EE1: [
      //     { category: "Aucune activit√©", value: 0, index: 4 },
      //     { category: "Recherche un emploi", value: 0, index: 3 },
      //     { category: "Poursuit des √©tudes", value: 0, index: 2 },
      //     { category: "A un emploi", value: 0, index: 1 },
      //   ],
      //   EE2: [
      //     { category: "Aucune activit√©", value: 5, index: 4 },
      //     { category: "Recherche un emploi", value: 20, index: 3 },
      //     { category: "Poursuit des √©tudes", value: 4, index: 2 },
      //     { category: "A un emploi", value: 105, index: 1 },
      //   ],
      //   EE3: [
      //     { category: "Aucune activit√©", value: 3, index: 4 },
      //     { category: "Recherche un emploi", value: 12, index: 3 },
      //     { category: "Poursuit des √©tudes", value: 5, index: 2 },
      //     { category: "A un emploi", value: 95, index: 1 },
      //   ],
      //   EE4: [
      //     { category: "Aucune activit√©", value: 3, index: 4 },
      //     { category: "Recherche un emploi", value: 4, index: 3 },
      //     { category: "Poursuit des √©tudes", value: 4, index: 2 },
      //     { category: "A un emploi", value: 95, index: 1 },
      //   ]
      // };

      // // Colors by category (consistent across all ES charts)
      // const statusColors = {
      //   "A un emploi": am5.color("#457B9D"),       // Muted blue (from CDD)
      //   "Recherche un emploi": am5.color("#D69B5A"),     // Muted sandy yellow (from Fonctionnaire)
      //   "Poursuit des √©tudes": am5.color("#2A9D8F"), // Teal-green (from Auto-Entrepreneur)
      //   "Aucune activit√©": am5.color("#A77A82")       // Softer rose taupe (from Mandataire Social)
      // };

      // // Create chart for each ES
      // function createDonutChartES(containerId, esLabel, data) {
      //   const root = am5.Root.new(containerId);
      //   root.setThemes([am5themes_Animated.new(root)]);

      //   const chart = root.container.children.push(
      //     am5percent.PieChart.new(root, {
      //       layout: root.verticalLayout,
      //       innerRadius: am5.percent(50),
      //       // outerWidth: am5.percent(50),
      //       paddingTop: 10,
      //     })
      //   );

      //   // Add label in the center
      //   chart.seriesContainer.children.push(
      //     am5.Label.new(root, {
      //       text: esLabel,
      //       fontSize: 18,
      //       fontWeight: "600",
      //       centerX: am5.percent(50),
      //       centerY: am5.percent(50),
      //       fill: am5.color("#333")
      //     })
      //   );

      //   const series = chart.series.push(
      //     am5percent.PieSeries.new(root, {
      //       valueField: "value",
      //       categoryField: "category",
      //       alignLabels: false
      //     })
      //   );

      //   // Configure the labels
      //   series.labels.template.setAll({
      //     text: "{value} | {valuePercentTotal.formatNumber('#.0')}%", // Display value and percentage
      //     fontSize: 14,
      //     radius: 0,
      //     fontFamily: "Segoe UI, Tahoma, Geneva, Verdana, sans-serif",
      //     fontWeight: "500",
      //     centerX: am5.percent(50),
      //     centerY: am5.percent(50),
      //     fill: am5.color("#333") // Temporary default color
      //   });

      //   series.labels.template.adapters.add("radius", (radius, target) => {
      //     const index = target.dataItem.dataContext.index;
      //     return index === 3 && esLabel === 'EE4' ? 22 : radius; // inside ‚Üí negative, outside ‚Üí positive
      //   });

      //   series.ticks.template.set("visible", false);
      //   // series.ticks.template.setAll({
      //   //   visible: true,
      //   //   stroke: am5.color("#0E3F2D"),
      //   //   strokeWidth: 3
      //   // });

      //   series.slices.template.adapters.add("fill", (fill, target) => {
      //     const cat = target.dataItem.dataContext.category;
      //     return statusColors[cat] || am5.color("#ccc");
      //   });

      //   series.slices.template.setAll({
      //     tooltipText: "{category}: {value} ({valuePercentTotal.formatNumber('#.0')}%)", // Update tooltip to include percentage
      //     stroke: am5.color("#fff"),
      //     strokeWidth: 1.5,
      //     cornerRadius: 6
      //   });

      //   // Set the data for the series
      //   series.data.setAll(data);

      //   // Update the label colors to match the slices
      //   series.labels.each((label) => {
      //     const dataItem = label.dataItem;
      //     if (dataItem) {
      //       const category = dataItem.get("category");
      //       const color = statusColors[category] || am5.color("#ccc");
      //       label.set("fill", color);
      //     }
      //   });
      // }

      // // Create all 4 charts
      // createDonutChartES("chart2-es1", "EE1", chart2Data.EE1);
      // createDonutChartES("chart2-es2", "EE2", chart2Data.EE2);
      // createDonutChartES("chart2-es3", "EE3", chart2Data.EE3);
      // createDonutChartES("chart2-es4", "EE4", chart2Data.EE4);


      // Chart 3: Type de Contrat (Horizontal Grouped Bar Chart)

      // Global variables to store chart data and root
      // Global variables to store chart data and root
      // Global variables
      let datasets3Combined = [
        { type: "CDI", EE1: 0, EE2: 63, EE3: 58, EE4: 64 },
        { type: "CDD", EE1: 0, EE2: 9, EE3: 11, EE4: 9 },
        { type: "Int√©rim", EE1: 0, EE2: 7, EE3: 3, EE4: 0 },
        { type: "Fonctionnaire", EE1: 0, EE2: 1, EE3: 1, EE4: 1 },
        { type: "Contractuel", EE1: 0, EE2: 3, EE3: 1, EE4: 1 },
        { type: "Auto-Entrepreneur", EE1: 0, EE2: 15, EE3: 15, EE4: 10 },
        { type: "G√©rant", EE1: 0, EE2: 3, EE3: 5, EE4: 4 },
        { type: "Ind√©pendant", EE1: 0, EE2: 2, EE3: 1, EE4: 3 },
        { type: "Mandataire Social", EE1: 0, EE2: 0, EE3: 0, EE4: 0 },
        { type: "Autre", EE1: 0, EE2: 2, EE3: 0, EE4: 1 }
      ];

      // let root3, chart3;

      // Create the chart
      var root3 = am5.Root.new("chart3");
      root3._logo.dispose();
      root3.setThemes([am5themes_Animated.new(root3)]);

      var chart3 = root3.container.children.push(am5xy.XYChart.new(root3, {
        layout: root3.verticalLayout,
        paddingTop: 20,
        paddingBottom: 50,
        panX: true,
        panY: true,
        wheelX: "panX",
        wheelY: "zoomY",
        pinchZoomX: true
      }));

      // Define custom color set
      chart3.get("colors").set("colors", [
        am5.color("#BCDCDC"), // EE1
        am5.color("#68B3B3"), // EE2
        am5.color("#2A8A8A"), // EE3
        am5.color("#0E4B4B")  // EE4
      ]);

      chart3.set("scrollbarY", am5.Scrollbar.new(root3, {
        orientation: "vertical",
      }));

      const top8Chart3 = datasets3Combined
        .sort((a, b) => (b.EE1 + b.EE2 + b.EE3 + b.EE4) - (a.EE1 + a.EE2 + a.EE3 + a.EE4))
        .slice(0, 8);

      const categoryBaseColors = {
        "CDI": "#1D3557",
        "CDD": "#457B9D",
        "Int√©rim": "#A8DADC",
        "Fonctionnaire": "#F4A261",
        "Contractuel": "#E76F51",
        "Auto-Entrepreneur": "#2A9D8F",
        "G√©rant": "#264653",
        "Ind√©pendant": "#6D597A",
        "Mandataire Social": "#B5838D",
        "Autre": "#ADB5BD"
      };

      function shadeColor(color, percent) {
        let f = parseInt(color.slice(1), 16),
          t = percent < 0 ? 0 : 255,
          p = Math.abs(percent) / 100,
          R = f >> 16,
          G = f >> 8 & 0x00FF,
          B = f & 0x0000FF;
        return "#" + (
          0x1000000 +
          (Math.round((t - R) * p) + R) * 0x10000 +
          (Math.round((t - G) * p) + G) * 0x100 +
          (Math.round((t - B) * p) + B)
        ).toString(16).slice(1);
      }

      // Create Y Axis (Categories)
      var yAxis3 = chart3.yAxes.push(
        am5xy.CategoryAxis.new(root3, {
          categoryField: "type",
          renderer: am5xy.AxisRendererY.new(root3, {
            minGridDistance: 40,
            inversed: true,
            cellStartLocation: 0.05,
            cellEndLocation: 0.95
          })
        })
      );
      yAxis3.data.setAll(top8Chart3);

      // Create X Axis (Values)
      var xAxis3 = chart3.xAxes.push(
        am5xy.ValueAxis.new(root3, {
          min: 0,
          renderer: am5xy.AxisRendererX.new(root3, {})
        })
      );

      // Function to create a series
      function makeSeries(name, field) {
        let esIndex = { "EE1": 50, "EE2": 20, "EE3": -20, "EE4": -50 }[name];

        let series = chart3.series.push(
          am5xy.ColumnSeries.new(root3, {
            name,
            xAxis: xAxis3,
            yAxis: yAxis3,
            valueXField: field,
            categoryYField: "type",
            clustered: true
          })
        );

        series.columns.template.setAll({
          tooltipText: `${name} - {categoryY}: {valueX}`,
          height: am5.percent(90),
          width: am5.percent(55),
          strokeOpacity: 0
        });

        series.columns.template.adapters.add("fill", function (fill, target) {
          let category = target.dataItem.dataContext.type;
          let base = categoryBaseColors[category] || "#999";
          return am5.color(shadeColor(base, esIndex));
        });

        series.columns.template.adapters.add("stroke", (stroke, target) => {
          let category = target.dataItem.dataContext.type;
          let base = categoryBaseColors[category] || "#999";
          return am5.color(shadeColor(base, esIndex));
        });

        series.bullets.push(function () {
          let label = am5.Label.new(root3, {
            fontSize: 12,
            fontFamily: "Segoe UI, Tahoma, Geneva, Verdana, sans-serif",
            fontWeight: "500",
            centerY: am5.percent(50),
            centerX: am5.percent(0),
            dx: 1
          });

          label.adapters.add("text", function (text, target) {
            let value = target.dataItem.get("valueX");
            return `${value}`;
          });

          label.adapters.add("fill", function (fill, target) {
            let category = target.dataItem.dataContext.type;
            let base = categoryBaseColors[category] || "#999";
            return am5.color(shadeColor(base, esIndex));
          });

          return am5.Bullet.new(root3, {
            locationX: 1,
            sprite: label
          });
        });

        series.data.setAll(top8Chart3);

        series.events.once("datavalidated", function () {
          am5.array.each(series.dataItems, function (dataItem) {
            if (dataItem.get("valueX") === 0) {
              dataItem.set("valueXWorking", 0.5);
            }
          });
        });
      }

      // Create grouped bars for EE1‚ÄìEE4
      makeSeries("EE1", "EE1");
      makeSeries("EE2", "EE2");
      makeSeries("EE3", "EE3");
      makeSeries("EE4", "EE4");

      // Initialize exporting - SIMPLIFIED
      root3.exporting = am5plugins_exporting.Exporting.new(root3, {
        filePrefix: "chart3",
        exportingMenu: null
      });

      // EXPORT FUNCTIONS - SIMPLIFIED AND RELIABLE
      function exportCSV() {
        console.log("Exporting CSV...");

        // Simple manual CSV export - most reliable method
        const headers = ["Type", "EE1", "EE2", "EE3", "EE4"];
        const csvContent = [
          headers.join(","),
          ...datasets3Combined.map(row => [
            `"${row.type}"`,
            row.EE1,
            row.EE2,
            row.EE3,
            row.EE4
          ].join(","))
        ].join("\n");

        // Create and download file
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");

        if (link.download !== undefined) {
          const url = URL.createObjectURL(blob);
          link.setAttribute("href", url);
          link.setAttribute("download", "chart3_data.csv");
          link.style.visibility = "hidden";
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);
          console.log("CSV export completed");
        } else {
          alert("CSV export not supported in this browser");
        }
      }

      function exportChart() {
        console.log("Exporting PNG...");

        if (!root3 || !root3.exporting) {
          alert("Export functionality not available");
          return;
        }

        // Use amCharts export with error handling
        root3.exporting.export("png", {
          quality: 0.9,
          maintainPixelRatio: true
        }).then(function (result) {
          console.log("PNG export successful");
        }).catch(function (error) {
          console.error("PNG export failed:", error);

          // Alternative method - try canvas export
          setTimeout(function () {
            try {
              const canvas = root3.dom.querySelector("canvas");
              if (canvas) {
                const link = document.createElement("a");
                link.download = "chart3.png";
                link.href = canvas.toDataURL("image/png");
                link.click();
                console.log("Canvas export successful");
              } else {
                alert("PNG export failed. Canvas not found.");
              }
            } catch (canvasError) {
              console.error("Canvas export also failed:", canvasError);
              alert("PNG export failed: " + error.message);
            }
          }, 500);
        });
      }

      // Setup dropdown toggle
      document.addEventListener('DOMContentLoaded', function () {
        const exportButton = document.getElementById("exportButton");
        const exportOptions = document.getElementById("exportOptions");

        if (exportButton && exportOptions) {
          exportButton.addEventListener("click", function (e) {
            e.preventDefault();
            const isVisible = exportOptions.style.display === "block";
            exportOptions.style.display = isVisible ? "none" : "block";
          });

          // Close when clicking outside
          document.addEventListener("click", function (e) {
            if (!exportButton.contains(e.target) && !exportOptions.contains(e.target)) {
              exportOptions.style.display = "none";
            }
          });
        }
      });

      // Test function - call this in console to debug
      window.testExport = function () {
        console.log("=== Export Test ===");
        console.log("root3 exists:", !!root3);
        console.log("chart3 exists:", !!chart3);
        console.log("exporting plugin:", !!root3?.exporting);
        console.log("am5plugins_exporting:", typeof am5plugins_exporting);
        console.log("datasets3Combined length:", datasets3Combined.length);

        // Test CSV export
        exportCSV();
      };

      // Alternative event listeners (add this at the end of your script)
      document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('csvExportBtn')?.addEventListener('click', exportCSV);
        document.getElementById('pngExportBtn')?.addEventListener('click', exportChart);
      });
      // makeSeries("EE1", "EE1", "#BCDCDC");
      // makeSeries("EE2", "EE2", "#68B3B3");
      // makeSeries("EE3", "EE3", "#2A8A8A");
      // makeSeries("EE4", "EE4", "#0E4B4B");


      // Chart 4: Niveau manag√©rial (Line Chart)
      const chart4DataLine = [
        { es: "EE1", Oui: 0, },
        { es: "EE2", Oui: 20, },
        { es: "EE3", Oui: 25, },
        { es: "EE4", Oui: 30, }
      ];

      function createLineChartManager(containerId, data) {
        const root = am5.Root.new(containerId);
        root._logo.dispose();

        root.setThemes([am5themes_Animated.new(root)]);

        const chart = root.container.children.push(
          am5xy.XYChart.new(root, {
            panX: false,
            panY: false,
            wheelX: "none",
            wheelY: "none",
            layout: root.verticalLayout
          })
        );

        // X Axis (Categories: EE1, EE2...)
        const xAxis = chart.xAxes.push(
          am5xy.CategoryAxis.new(root, {
            categoryField: "es",
            renderer: am5xy.AxisRendererX.new(root, { minGridDistance: 30 }),
            tooltip: am5.Tooltip.new(root, {})
          })
        );
        xAxis.data.setAll(data);

        // Y Axis (Values)
        const yAxis = chart.yAxes.push(
          am5xy.ValueAxis.new(root, {
            renderer: am5xy.AxisRendererY.new(root, {})
          })
        );

        // Line series function
        function createSeries(field, name, color) {
          const series = chart.series.push(
            am5xy.LineSeries.new(root, {
              name: name,
              xAxis: xAxis,
              yAxis: yAxis,
              valueYField: field,
              categoryXField: "es",
              stroke: color,
              fill: color,
              tooltip: am5.Tooltip.new(root, {
                labelText: `Ayant un poste de Manager: {valueY}`
              })
            })
          );

          series.strokes.template.setAll({
            strokeWidth: 3
          });

          series.bullets.push(() =>
            am5.Bullet.new(root, {
              sprite: am5.Circle.new(root, {
                radius: 5,
                fill: color,
                stroke: am5.color(0xffffff),
                strokeWidth: 2
              })
            })
          );

          series.data.setAll(data);
        }

        // Add "Oui" and "Non" series
        createSeries("Oui", "Oui", am5.color("#2A9D8F"));
        // createSeries("Non", "Non", am5.color("#A77A82"));

        chart.set("cursor", am5xy.XYCursor.new(root, {
          behavior: "none",
          xAxis: xAxis,
          yAxis: yAxis
        }));

        chart.appear(1000, 100);
      }

      // Render the chart
      createLineChartManager("chart4", chart4DataLine);


      // Chart 5: Top 8 fonctions with tabs and dynamic update
      // Chart 5: Top 8 fonctions (Grouped Horizontal Bar Chart)

      var root5 = am5.Root.new("chart5");
      root5._logo.dispose();
      root5.setThemes([am5themes_Animated.new(root5)]);

      var chart5 = root5.container.children.push(am5xy.XYChart.new(root5, {
        layout: root5.verticalLayout,
        paddingTop: 20,
        paddingBottom: 50,
        panX: true,
        panY: true,
        wheelX: "panX",
        wheelY: "zoomY",
        pinchZoomX: true
      }));

      chart5.set("scrollbarY", am5.Scrollbar.new(root5, {
        orientation: "vertical"
      }));

      // Your original data
      const datasets5 = {
        EE1: [
          { category: "Repr√©sentant commercial", value: 0 },
          { category: "Charg√©(e) de communication", value: 0 },
          { category: "Charg√©(e) d'√©tudes marketing", value: 0 },
          { category: "Responsable de march√©", value: 0 },
          { category: "Responsable marketing", value: 0 },
          { category: "Responsable de marque", value: 0 },
          { category: "Chef de produit", value: 0 },
          { category: "Chef de projet marketing", value: 0 },
          { category: "Responsable de secteur", value: 0 },
          { category: "Commercial", value: 0 },
          { category: "Conseiller commercial", value: 0 },
          { category: "Responsable des ventes", value: 0 },
          { category: "Directeur commercial", value: 0 },
          { category: "Responsable performance marketing et ventes", value: 0 },
          { category: "Responsable de d√©partement/univers", value: 0 },
          { category: "Responsable des √©tudes marketing", value: 0 },
          { category: "Autre", value: 0 }
        ],
        EE2: [
          { category: "Repr√©sentant commercial", value: 3 },
          { category: "Charg√©(e) de communication", value: 1 },
          { category: "Charg√©(e) d'√©tudes marketing", value: 0 },
          { category: "Responsable de march√©", value: 0 },
          { category: "Responsable marketing", value: 0 },
          { category: "Responsable de marque", value: 0 },
          { category: "Chef de produit", value: 0 },
          { category: "Chef de projet marketing", value: 0 },
          { category: "Responsable de secteur", value: 3 },
          { category: "Commercial", value: 19 },
          { category: "Conseiller commercial", value: 24 },
          { category: "Responsable des ventes", value: 4 },
          { category: "Directeur commercial", value: 1 },
          { category: "Responsable performance marketing et ventes", value: 0 },
          { category: "Responsable de d√©partement/univers", value: 1 },
          { category: "Responsable des √©tudes marketing", value: 1 },
          { category: "Autre", value: 48 }
        ],
        EE3: [
          { category: "Repr√©sentant commercial", value: 3 },
          { category: "Charg√©(e) de communication", value: 0 },
          { category: "Charg√©(e) d'√©tudes marketing", value: 0 },
          { category: "Responsable de march√©", value: 0 },
          { category: "Responsable marketing", value: 0 },
          { category: "Responsable de marque", value: 0 },
          { category: "Chef de produit", value: 0 },
          { category: "Chef de projet marketing", value: 1 },
          { category: "Responsable de secteur", value: 2 },
          { category: "Commercial", value: 20 },
          { category: "Conseiller commercial", value: 21 },
          { category: "Responsable des ventes", value: 5 },
          { category: "Directeur commercial", value: 0 },
          { category: "Responsable performance marketing et ventes", value: 0 },
          { category: "Responsable de d√©partement/univers", value: 1 },
          { category: "Responsable des √©tudes marketing", value: 0 },
          { category: "Autre", value: 42 }
        ],
        EE4: [
          { category: "Repr√©sentant commercial", value: 4 },
          { category: "Charg√©(e) de communication", value: 1 },
          { category: "Charg√©(e) d'√©tudes marketing", value: 0 },
          { category: "Responsable de march√©", value: 0 },
          { category: "Responsable marketing", value: 0 },
          { category: "Responsable de marque", value: 0 },
          { category: "Chef de produit", value: 0 },
          { category: "Chef de projet marketing", value: 0 },
          { category: "Responsable de secteur", value: 0 },
          { category: "Commercial", value: 14 },
          { category: "Conseiller commercial", value: 19 },
          { category: "Responsable des ventes", value: 5 },
          { category: "Directeur commercial", value: 1 },
          { category: "Responsable performance marketing et ventes", value: 0 },
          { category: "Responsable de d√©partement/univers", value: 1 },
          { category: "Responsable des √©tudes marketing", value: 0 },
          { category: "Autre", value: 48 }
        ]
      };

      // Step 1: Combine into grouped format
      function combineESData(datasets) {
        const combined = {};
        for (const es of ["EE1", "EE2", "EE3", "EE4"]) {
          datasets[es].forEach(item => {
            if (!combined[item.category]) {
              combined[item.category] = {
                category: item.category, EE1: 0, EE2: 0, EE3: 0, EE4: 0
              };
            }
            combined[item.category][es] = item.value;
          });
        }
        return Object.values(combined);
      }

      let dataset5Combined = combineESData(datasets5);
      const top8 = dataset5Combined
        .sort((a, b) => (b.EE1 + b.EE2 + b.EE3 + b.EE4) - (a.EE1 + a.EE2 + a.EE3 + a.EE4))
        .slice(0, 8);

      // yAxis5.data.setAll(top8);
      // series.data.setAll(top8); // for each series


      // Step 2: Set base color per category
      const jobBaseColors = {
        "Repr√©sentant commercial": "#1D3557",
        "Charg√©(e) de communication": "#457B9D",
        "Charg√©(e) d'√©tudes marketing": "#A8DADC",
        "Responsable de march√©": "#F4A261",
        "Responsable marketing": "#E76F51",
        "Responsable de marque": "#2A9D8F",
        "Chef de produit": "#264653",
        "Chef de projet marketing": "#6D597A",
        "Responsable de secteur": "#B5838D",
        "Commercial": "#8ECAE6",
        "Conseiller commercial": "#219EBC",
        "Responsable des ventes": "#023047",
        "Directeur commercial": "#FFB703",
        "Responsable performance marketing et ventes": "#FB8500",
        "Responsable de d√©partement/univers": "#9B5DE5",
        "Responsable des √©tudes marketing": "#F15BB5",
        "Autre": "#ADB5BD"
      };

      // Shading utility (same as Chart 3)
      function shadeColor(color, percent) {
        let f = parseInt(color.slice(1), 16),
          t = percent < 0 ? 0 : 255,
          p = Math.abs(percent) / 100,
          R = f >> 16,
          G = f >> 8 & 0x00FF,
          B = f & 0x0000FF;
        return "#" + (
          0x1000000 +
          (Math.round((t - R) * p) + R) * 0x10000 +
          (Math.round((t - G) * p) + G) * 0x100 +
          (Math.round((t - B) * p) + B)
        ).toString(16).slice(1);
      }

      // Step 3: Create axes
      const yAxis5 = chart5.yAxes.push(
        am5xy.CategoryAxis.new(root5, {
          categoryField: "category",
          renderer: am5xy.AxisRendererY.new(root5, {
            minGridDistance: 40,
            inversed: true,
            cellStartLocation: 0.05,
            cellEndLocation: 0.95
          })
        })
      );
      yAxis5.data.setAll(top8);

      const xAxis5 = chart5.xAxes.push(
        am5xy.ValueAxis.new(root5, {
          min: 0,
          renderer: am5xy.AxisRendererX.new(root5, {})
        })
      );

      // Step 4: Create grouped series
      function makeSeries5(name, field) {
        const esShade = { EE1: 50, EE2: 20, EE3: -20, EE4: -50 }[name];

        const series = chart5.series.push(
          am5xy.ColumnSeries.new(root5, {
            name,
            xAxis: xAxis5,
            yAxis: yAxis5,
            valueXField: field,
            categoryYField: "category",
            clustered: true
          })
        );

        series.columns.template.setAll({
          tooltipText: `${name} - {categoryY}: {valueX}`,
          height: am5.percent(90),
          width: am5.percent(55),
          strokeOpacity: 0
        });

        // Dynamic color per category + ES shade
        series.columns.template.adapters.add("fill", function (fill, target) {
          const category = target.dataItem.dataContext.category;
          const base = jobBaseColors[category] || "#999";
          return am5.color(shadeColor(base, esShade));
        });

        series.columns.template.adapters.add("stroke", function (stroke, target) {
          const category = target.dataItem.dataContext.category;
          const base = jobBaseColors[category] || "#999";
          return am5.color(shadeColor(base, esShade));
        });

        // Label bullet (value)
        series.bullets.push(function () {
          let label = am5.Label.new(root5, {
            fontSize: 13,
            centerY: am5.percent(50),
            centerX: am5.percent(0),
            fontFamily: "Segoe UI, Tahoma, Geneva, Verdana, sans-serif", // match your header
            fontWeight: "500",
            dx: 1
          });

          label.adapters.add("text", function (text, target) {
            const value = target.dataItem.get("valueX");
            let esLabel = target.dataItem.component.get("name");  // ‚Üê gets "EE1", etc.
            return `${value}`;
          });

          label.adapters.add("fill", function (fill, target) {
            const category = target.dataItem.dataContext.category;
            const base = jobBaseColors[category] || "#999";
            return am5.color(shadeColor(base, esShade));
          });

          return am5.Bullet.new(root5, {
            locationX: 1,
            sprite: label
          });
        });

        // Set data + handle 0 values
        series.data.setAll(top8);
        series.events.once("datavalidated", function () {
          am5.array.each(series.dataItems, function (dataItem) {
            if (dataItem.get("valueX") === 0) {
              dataItem.set("valueXWorking", 0.5);
            }
          });
        });
      }

      // Step 5: Create 4 ES series
      makeSeries5("EE1", "EE1");
      makeSeries5("EE2", "EE2");
      makeSeries5("EE3", "EE3");
      makeSeries5("EE4", "EE4");




      // Chart 6: Top 8 entreprises (Bar Chart with Logos)
      // Chart 6: Top 8 Companies (Circle Layout with Logos) - HTML/CSS SolutionMore actions
      // Clear the chart container and replace with HTML
      document.getElementById('chart6').innerHTML = `
      <style>
        .company-grid {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          padding: 20px;
          gap: 15px; /* Reduced gap to prevent excessive spacing */
          width: 100%;
          box-sizing: border-box;
        }

        .company-item {
          display: flex;
          padding-top: 20px;
          flex-direction: column;
          align-items: center;
          justify-content: flex-start;
          cursor: pointer;
          transition: transform 0.2s ease;
          
          flex: 1 1 160px; /* flex-grow, flex-shrink, flex-basis */
          max-width: 25%;   /* Max 5 per row on large screens */
          box-sizing: border-box;
        }

        .company-item:hover {
          transform: scale(1.05);
        }

        .company-circle {
          /* Use percentage-based sizing relative to the parent */
          width: 80%;
          aspect-ratio: 1 / 1; /* Ensure the circle stays circular */
          max-width: 130px; /* Maximum size for larger screens */
          border: 0px solid #8FD2D2;
          border-radius: 50%;
          background: white;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-bottom: 8px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          transition: border-width 0.2s ease;
        }

        .company-item:hover .company-circle {
          border-width: 4px;
        }

        .company-logo {
          max-width: 60%;
          max-height: 60%;
          height: auto;
          object-fit: contain;
        }

        .company-count {
          font-size: clamp(10px, 1.5vw, 16px);
          font-weight: bold;
          color: #0E3F2D;
          margin-bottom: 2px;
          text-align: center;
        }

        .company-percent {
          font-size: clamp(8px, 1.2vw, 13px);
          color: #666666;
          text-align: center;
        }

        .company-name {
          font-size: clamp(8px, 1vw, 12px);
          color: #888888;
          text-align: center;
          margin-top: 5px;
        }

        /* Media queries for better control at different screen sizes */
        @media (max-width: 800px) {
          .company-item {
            width: calc(25% - 15px); /* 4 items per row */
            min-width: 90px;
          }

          .company-circle {
            width: 75%;
            max-width: 100px;
          }
        }

        @media (max-width: 600px) {
          .company-item {
            width: calc(33.33% - 15px); /* 3 items per row */
            min-width: 80px;
          }

          .company-circle {
            width: 70%;
            max-width: 90px;
          }
        }

        @media (max-width: 400px) {
          .company-item {
            width: calc(50% - 15px); /* 2 items per row */
            min-width: 70px;
          }

          .company-circle {
            width: 65%;
            max-width: 80px;
          }
        }
      </style>
      
      <div class="company-grid" id="companyGrid">
        <!-- Companies will be inserted here -->
      </div>
    `;

      // Company datasets per ES
      const datasets6 = {
        EE1: [
          { company: "Darty", value: 0, logo: "https://upload.wikimedia.org/wikipedia/commons/b/b0/Darty.svg" },
          { company: "Decathlon", value: 0, logo: "https://www.decathlon.media/app/fo-html/vues/commun/img/commun/logo-decathlon.svg" },
          { company: "Auchan", value: 0, logo: "https://upload.wikimedia.org/wikipedia/fr/c/cd/Logo_Auchan_%282015%29.svg" },
          { company: "Carrefour", value: 0, logo: "https://upload.wikimedia.org/wikipedia/fr/3/3b/Logo_Carrefour.svg" },
          { company: "Pernod Ricard", value: 0, logo: "https://upload.wikimedia.org/wikipedia/commons/e/e2/Pernod_Ricard_logo_2019.svg" },
          { company: "AXA Assurances", value: 0, logo: "https://upload.wikimedia.org/wikipedia/commons/9/94/AXA_Logo.svg" },
          { company: "Soci√©t√© G√©n√©rale", value: 0, logo: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Soci%C3%A9t%C3%A9_G%C3%A9n%C3%A9rale.svg" },
          { company: "Orange", value: 0, logo: "https://upload.wikimedia.org/wikipedia/commons/c/c8/Orange_logo.svg" },
          // { company: "Other", value: 0, logo: "https://www.svgrepo.com/show/490660/company.svg" }
        ],
        EE2: [
          { company: "Darty", value: 4, logo: "https://upload.wikimedia.org/wikipedia/commons/b/b0/Darty.svg" },
          { company: "Decathlon", value: 9, logo: "https://www.decathlon.media/app/fo-html/vues/commun/img/commun/logo-decathlon.svg" },
          { company: "Auchan", value: 5, logo: "https://upload.wikimedia.org/wikipedia/fr/c/cd/Logo_Auchan_%282015%29.svg" },
          { company: "Carrefour", value: 4, logo: "https://upload.wikimedia.org/wikipedia/fr/3/3b/Logo_Carrefour.svg" },
          { company: "Pernod Ricard", value: 4, logo: "https://upload.wikimedia.org/wikipedia/commons/e/e2/Pernod_Ricard_logo_2019.svg" },
          { company: "AXA Assurances", value: 5, logo: "https://upload.wikimedia.org/wikipedia/commons/9/94/AXA_Logo.svg" },
          { company: "Soci√©t√© G√©n√©rale", value: 5, logo: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Soci%C3%A9t%C3%A9_G%C3%A9n%C3%A9rale.svg" },
          { company: "Orange", value: 6, logo: "https://upload.wikimedia.org/wikipedia/commons/c/c8/Orange_logo.svg" },
          // { company: "Other", value: 65, logo: "https://www.svgrepo.com/show/490660/company.svg" }
        ],
        EE3: [
          { company: "Darty", value: 6, logo: "https://upload.wikimedia.org/wikipedia/commons/b/b0/Darty.svg" },
          { company: "Decathlon", value: 11, logo: "https://www.decathlon.media/app/fo-html/vues/commun/img/commun/logo-decathlon.svg" },
          { company: "Auchan", value: 6, logo: "https://upload.wikimedia.org/wikipedia/fr/c/cd/Logo_Auchan_%282015%29.svg" },
          { company: "Carrefour", value: 7, logo: "https://upload.wikimedia.org/wikipedia/fr/3/3b/Logo_Carrefour.svg" },
          { company: "Pernod Ricard", value: 4, logo: "https://upload.wikimedia.org/wikipedia/commons/e/e2/Pernod_Ricard_logo_2019.svg" },
          { company: "AXA Assurances", value: 6, logo: "https://upload.wikimedia.org/wikipedia/commons/9/94/AXA_Logo.svg" },
          { company: "Soci√©t√© G√©n√©rale", value: 8, logo: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Soci%C3%A9t%C3%A9_G%C3%A9n%C3%A9rale.svg" },
          { company: "Orange", value: 8, logo: "https://upload.wikimedia.org/wikipedia/commons/c/c8/Orange_logo.svg" },
          // { company: "Other", value: 0, logo: "https://www.svgrepo.com/show/490660/company.svg" }
        ],
        EE4: [
          { company: "Darty", value: 6, logo: "https://upload.wikimedia.org/wikipedia/commons/b/b0/Darty.svg" },
          { company: "Decathlon", value: 11, logo: "https://www.decathlon.media/app/fo-html/vues/commun/img/commun/logo-decathlon.svg" },
          { company: "Auchan", value: 8, logo: "https://upload.wikimedia.org/wikipedia/fr/c/cd/Logo_Auchan_%282015%29.svg" },
          { company: "Carrefour", value: 8, logo: "https://upload.wikimedia.org/wikipedia/fr/3/3b/Logo_Carrefour.svg" },
          { company: "Pernod Ricard", value: 7, logo: "https://upload.wikimedia.org/wikipedia/commons/e/e2/Pernod_Ricard_logo_2019.svg" },
          { company: "AXA Assurances", value: 4, logo: "https://upload.wikimedia.org/wikipedia/commons/9/94/AXA_Logo.svg" },
          { company: "Soci√©t√© G√©n√©rale", value: 7, logo: "https://upload.wikimedia.org/wikipedia/commons/9/9d/Soci%C3%A9t%C3%A9_G%C3%A9n%C3%A9rale.svg" },
          { company: "Orange", value: 9, logo: "https://upload.wikimedia.org/wikipedia/commons/c/c8/Orange_logo.svg" },
          // { company: "Other", value: 0, logo: "https://www.svgrepo.com/show/490660/company.svg" }
        ]
      };

      function renderCompaniesChart(esKey) {
        const data = datasets6[esKey];
        const sorted = [...data].sort((a, b) => b.value - a.value);
        const top8 = sorted.slice(0, 8);

        const topTotal = top8.reduce((sum, item) => sum + item.value, 0);
        const total = 105;
        const percentage = Math.round((topTotal / total) * 100);

        // Update title
        document.getElementById('chart6-title').innerText = `Les 8 premi√®res entreprises : ${topTotal} / ${percentage}%`;

        // Clear previous content
        const companyGrid = document.getElementById('companyGrid');
        companyGrid.innerHTML = "";

        // Add percent to each company
        top8.forEach(company => {
          const companyItem = document.createElement('div');
          companyItem.className = 'company-item';
          const percent = Math.round((company.value / total) * 100);

          companyItem.innerHTML = `
          <div class="company-circle">
            <img src="${company.logo}" alt="${company.company}" class="company-logo" onerror="this.style.display='none'">
          </div>
          <div class="company-count">${company.value}</div>
          <div class="company-percent">${percent}%</div>
          <div class="company-name">${company.company}</div>
        `;

          companyItem.title = `${company.company}: ${company.value} students (${percent}%)`;

          companyItem.addEventListener("click", () => {
            console.log(`Clicked on ${company.company}: ${company.value} students`);
          });

          companyGrid.appendChild(companyItem);
        });
      }

      renderCompaniesChart("EE2"); // Initial render

      document.querySelectorAll(".tab-button6").forEach(button => {
        button.addEventListener("click", () => {
          document.querySelectorAll(".tab-button6").forEach(btn => btn.classList.remove("active"));
          button.classList.add("active");

          const esKey = button.getAttribute("data-tab");
          renderCompaniesChart(esKey);
        });
      });

    });
  </script>

  <script>
    function toggleAnalysis(id) {
      const section = document.getElementById(id);
      if (section.style.display === "none" || section.style.display === "") {
        section.style.display = "block";
      } else {
        section.style.display = "none";
      }
    }
  </script>

  <script>
    // Pie Chart A: Total vs Graduated Students
    am5.ready(function () {
      var rootA = am5.Root.new("pieChartA");
      rootA._logo.dispose();

      rootA.setThemes([am5themes_Animated.new(rootA)]);

      var chartA = rootA.container.children.push(am5percent.PieChart.new(rootA, {
        layout: rootA.horizontalLayout,
        innerRadius: am5.percent(50),
        radius: am5.percent(70),
        // paddingLeft: 70
      }));

      var seriesA = chartA.series.push(am5percent.PieSeries.new(rootA, {
        valueField: "value",
        categoryField: "category"
      }));

      // Add spacing between slices
      seriesA.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8 // Pull each slice slightly outward
      });

      // Format label with integer percentage
      seriesA.labels.template.setAll({
        text: "{category}: {value} ({valuePercentTotal.formatNumber('#.#')}%)",
        fontSize: 13,
        populateText: true,
        maxWidth: 100,
        oversizedBehavior: "wrap",
        fontWeight: "500",
        fill: am5.color("#333"),
        // radius: -20,             // Positive moves outward, negative moves inward
        // labelRadius: 30,        // Explicit label distance from center (can use instead of radius)
        // paddingRight: 100
      });

      seriesA.slices.template.setAll({
        tooltipText: "{category}: {value} ({valuePercentTotal.formatNumber('#.#')}%)", // Update tooltip to include percentage
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
        cornerRadius: 6
      });

      seriesA.data.setAll([
        { category: "Dipl√¥m√©", value: 318 },
        { category: "Non dipl√¥m√©", value: 383 - 318 }
      ]);

      seriesA.appear(1000, 100);
    });

    // Pie Chart B: Number of Surveys Sent
    am5.ready(function () {
      // Chart chartSent: Niveau manag√©rial (Line Chart)
      const chart4DataLine = [
        { es: "EE1", envoy√©: 318, },
        { es: "EE2", envoy√©: 140, },
        { es: "EE3", envoy√©: 136, },
        { es: "EE4", envoy√©: 131, }
      ];

      function createLineChartManager(containerId, data) {
        const root = am5.Root.new(containerId);
        root._logo.dispose();
        root.setThemes([am5themes_Animated.new(root)]);

        const chart = root.container.children.push(
          am5xy.XYChart.new(root, {
            panX: false,
            panY: false,
            wheelX: "none",
            wheelY: "none",
            layout: root.verticalLayout
          })
        );

        // X Axis (Categories: EE1, EE2...)
        const xAxis = chart.xAxes.push(
          am5xy.CategoryAxis.new(root, {
            categoryField: "es",
            renderer: am5xy.AxisRendererX.new(root, { minGridDistance: 30 }),
            tooltip: am5.Tooltip.new(root, {})
          })
        );
        xAxis.data.setAll(data);

        // Y Axis (Values)
        const yAxis = chart.yAxes.push(
          am5xy.ValueAxis.new(root, {
            renderer: am5xy.AxisRendererY.new(root, {})
          })
        );

        // Line series function
        function createSeries(field, name, color) {
          const series = chart.series.push(
            am5xy.LineSeries.new(root, {
              name: name,
              xAxis: xAxis,
              yAxis: yAxis,
              valueYField: field,
              categoryXField: "es",
              stroke: color,
              fill: color,
              tooltip: am5.Tooltip.new(root, {
                labelText: `envoy√©: {valueY}`
              })
            })
          );

          series.strokes.template.setAll({
            strokeWidth: 3
          });

          series.bullets.push(() =>
            am5.Bullet.new(root, {
              sprite: am5.Circle.new(root, {
                radius: 5,
                fill: color,
                stroke: am5.color(0xffffff),
                strokeWidth: 2
              })
            })
          );

          // Add labels above each point
          series.bullets.push(() =>
            am5.Bullet.new(root, {
              locationY: 0,
              sprite: am5.Label.new(root, {
                populateText: true,
                text: "{valueY}", // This now works
                centerY: am5.p100,
                centerX: am5.p60,
                dy: 0,
                fill: color,
                fontWeight: "500",
                fontSize: 14
              })
            })
          );
          series.data.setAll(data);
        }

        // Add "Oui" and "Non" series
        createSeries("envoy√©", "envoy√©", am5.color("#2A9D8F"));
        // createSeries("Non", "Non", am5.color("#A77A82"));

        chart.set("cursor", am5xy.XYCursor.new(root, {
          behavior: "none",
          xAxis: xAxis,
          yAxis: yAxis
        }));

        chart.appear(1000, 100);
      }

      // Render the chart
      createLineChartManager("chartSent", chart4DataLine);

    });
  </script>

  <script>
    am5.ready(function () {

      // France flag based color
      // const manualColorMap = {
      //   // Blues
      //   "FR-BRE": am5.color(0xA3C9F9), // light sky blue
      //   "FR-NOR": am5.color(0x7FB4F3), // medium blue
      //   "FR-HDF": am5.color(0x4F97EA), // strong blue
      //   "FR-GES": am5.color(0x2D76D3), // deep blue

      //   // Whites / Neutral grays
      //   "FR-PDL": am5.color(0xF5F5F5), // near-white
      //   "FR-CVL": am5.color(0xDDDDDD), // very light gray
      //   "FR-IDF": am5.color(0xCCCCCC), // light gray
      //   "FR-BFC": am5.color(0xBBBBBB), // medium-light gray


      //   // Reds
      //   "FR-NAQ": am5.color(0xF7A8A8), // light red
      //   "FR-ARA": am5.color(0xF28585), // medium red
      //   "FR-OCC": am5.color(0xE35D5D), // stronger red
      //   "FR-PAC": am5.color(0xD63A3A),  // deep red
      //   "FR-COR": am5.color(0x8B0000) // sssss
      // };

      // gradient based on bigger smaller size
      const manualColorMap = {
        "FR-PAC": am5.color(0x002F6C), // very dark blue (70)
        "FR-IDF": am5.color(0x174EA6), // dark blue (47)
        "FR-OCC": am5.color(0x2F66C7), // medium-dark blue (45)
        "FR-NAQ": am5.color(0x4785E8), // medium blue (31)
        "FR-GES": am5.color(0x66A2F2), // medium-light blue (30)
        "FR-ARA": am5.color(0x85B9F5), // lighter blue (21)
        "FR-HDF": am5.color(0x9FCBFA), // soft light blue (18)
        "FR-NOR": am5.color(0xB5D9FC), // pale blue (13)
        "FR-BRE": am5.color(0xCDE6FD), // very pale blue (9)
        "FR-PDL": am5.color(0xDEEFFD), // near-white blue (8)
        "FR-CVL": am5.color(0xEDF6FE), // slightly cooler near-white (2)
        "FR-BFC": am5.color(0xDEEFFD), // slightly warmer near-white (2)
        "FR-COR": am5.color(0xEDF6FE)  // light gray (1)
      };

      const manualColorMapSalaries = {
        "FR-IDF": am5.color(0x002F6C), // darkest blue (highest salary)
        "FR-PAC": am5.color(0x174EA6), // very dark blue
        "FR-ARA": am5.color(0x2F66C7), // dark blue
        "FR-NAQ": am5.color(0x4785E8), // medium blue
        "FR-GES": am5.color(0x4785E8), // medium blue
        "FR-OCC": am5.color(0x66A2F2), // light-medium blue
        "FR-BFC": am5.color(0x66A2F2), // light-medium blue
        "FR-PDL": am5.color(0x85B9F5), // pale-medium blue
        "FR-HDF": am5.color(0x9FCBFA), // pale blue
        "FR-BRE": am5.color(0xB5D9FC), // very pale blue
        "FR-NOR": am5.color(0xB5D9FC), // very pale blue
        "FR-COR": am5.color(0xEDF6FE), // no data
        "FR-CVL": am5.color(0xEDF6FE)  // no data
      };

      const regionNames = {
        "FR-BRE": "Bretagne",
        "FR-NOR": "Normandie",
        "FR-HDF": "Hauts-de-France",
        "FR-GES": "Grand Est",
        "FR-PDL": "Pays de la Loire",
        "FR-CVL": "Centre-Val de Loire",
        "FR-IDF": "√éle-de-France",
        "FR-BFC": "Bourgogne-Franche-Comt√©",
        "FR-NAQ": "Nouvelle-Aquitaine",
        "FR-ARA": "Auvergne-Rh√¥ne-Alpes",
        "FR-OCC": "Occitanie",
        "FR-PAC": "Provence-Alpes-C√¥te d'Azur",
        "FR-COR": "Corse"
      };

      function createFranceMap(divId, data, labelField) {
        const root = am5.Root.new(divId);
        root._logo.dispose();
        root.setThemes([am5themes_Animated.new(root)]);

        const chart = root.container.children.push(
          am5map.MapChart.new(root, {
            panX: "none",
            panY: "none",
            wheelY: "none",
            projection: am5map.geoMercator()
          })
        );

        const polygonSeries = chart.series.push(
          am5map.MapPolygonSeries.new(root, {
            geoJSON: am5geodata_franceLow,
            valueField: "value",
            calculateAggregates: true
          })
        );

        polygonSeries.mapPolygons.template.setAll({
          tooltipText: "{name}: {" + labelField + "}",
          interactive: true,
          cursorOverStyle: "pointer"
        });

        // ‚ú® Enable hover state
        polygonSeries.mapPolygons.template.states.create("hover", {
          fill: am5.color(0xffd700) // golden color or whatever you prefer
        });

        // ‚ú® Allow color binding via data
        polygonSeries.mapPolygons.template.set("fillField", "fill");

        // polygonSeries.set("heatRules", [{
        //   target: polygonSeries.mapPolygons.template,
        //   dataField: "value",
        //   min: am5.color(0xD6EFFF), // light blue
        //   max: am5.color(0x0033CC), // dark blue
        //   key: "fill"
        // }]);

        polygonSeries.mapPolygons.template.adapters.add("fill", (fill, target) => {
          const dataItem = target.dataItem;
          if (dataItem && dataItem.dataContext && dataItem.dataContext.fill) {
            return dataItem.dataContext.fill;
          }
          return fill;
        });

        // polygonSeries.mapPolygons.template.states.create("hover", {
        //   fill: am5.color(0xffd700), // e.g., golden hover color for contrast
        //   duration: 200
        // });


        const dataItems = Object.entries(data).map(([id, value]) => {
          let numericValue = typeof value === "string"
            ? parseInt(value.replace(/[^\d]/g, ""))
            : value;

          return {
            id,
            value: numericValue,
            [labelField]: value,
            fill: manualColorMap[id] || am5.color(0xd6efff) // default if not specified
          };
        });


        polygonSeries.data.setAll(dataItems);
        chart.appear(1000, 100);
      }

      function createFranceMapSalary(divId, data, labelField) {
        const root = am5.Root.new(divId);
        root._logo.dispose();
        root.setThemes([am5themes_Animated.new(root)]);

        const chart = root.container.children.push(
          am5map.MapChart.new(root, {
            panX: "none",
            panY: "none",
            wheelY: "none",
            projection: am5map.geoMercator()
          })
        );

        const polygonSeries = chart.series.push(
          am5map.MapPolygonSeries.new(root, {
            geoJSON: am5geodata_franceLow,
            valueField: "value",
            calculateAggregates: true
          })
        );

        polygonSeries.mapPolygons.template.setAll({
          tooltipText: "{name}: {" + labelField + "}",
          interactive: true,
          cursorOverStyle: "pointer"
        });

        // ‚ú® Enable hover state
        polygonSeries.mapPolygons.template.states.create("hover", {
          fill: am5.color(0xffd700) // golden color or whatever you prefer
        });

        // ‚ú® Allow color binding via data
        polygonSeries.mapPolygons.template.set("fillField", "fill");

        // polygonSeries.set("heatRules", [{
        //   target: polygonSeries.mapPolygons.template,
        //   dataField: "value",
        //   min: am5.color(0xD6EFFF), // light blue
        //   max: am5.color(0x0033CC), // dark blue
        //   key: "fill"
        // }]);

        polygonSeries.mapPolygons.template.adapters.add("fill", (fill, target) => {
          const dataItem = target.dataItem;
          if (dataItem && dataItem.dataContext && dataItem.dataContext.fill) {
            return dataItem.dataContext.fill;
          }
          return fill;
        });

        // polygonSeries.mapPolygons.template.states.create("hover", {
        //   fill: am5.color(0xffd700), // e.g., golden hover color for contrast
        //   duration: 200
        // });


        const dataItems = Object.entries(data).map(([id, value]) => {
          let numericValue = typeof value === "string"
            ? parseInt(value.replace(/[^\d]/g, ""))
            : value;

          return {
            id,
            value: numericValue,
            [labelField]: value,
            fill: manualColorMapSalaries[id] || am5.color(0xd6efff) // default if not specified
          };
        });


        polygonSeries.data.setAll(dataItems);
        chart.appear(1000, 100);
      }

      const studentsData = {
        "FR-PAC": 66, // Provence-Alpes-C√¥te d'Azur
        "FR-OCC": 41, // Occitanie
        "FR-GES": 34, // Grand Est
        "FR-IDF": 34, // √éle-de-France
        "FR-NOR": 33, // Normandie
        "FR-ARA": 31, // Auvergne-Rh√¥ne-Alpes
        "FR-HDF": 30, // Hauts-de-France
        "FR-NAQ": 22, // Nouvelle-Aquitaine
        "FR-PDL": 14, // Pays de la Loire
        "FR-BRE": 12, // Bretagne
        "FR-BFC": 1, // Bourgogne-Franche-Comt√©
        "FR-CVL": 0, // Centre-Val de Loire
        "FR-COR": 0,    // Corse (no data)
      };

      const salaryData = {
        "FR-IDF": '3,100 ‚Ç¨',   // √éle-de-France
        "FR-PAC": '2,700 ‚Ç¨',   // Provence-Alpes-C√¥te d'Azur
        "FR-ARA": '2,600 ‚Ç¨',   // Auvergne-Rh√¥ne-Alpes
        "FR-NAQ": '2,500 ‚Ç¨',   // Nouvelle-Aquitaine
        "FR-GES": '2,500 ‚Ç¨',   // Grand Est
        "FR-OCC": '2,400 ‚Ç¨',   // Occitanie
        "FR-BFC": '2,400 ‚Ç¨',   // Bourgogne-Franche-Comt√©
        "FR-PDL": '2,300 ‚Ç¨',   // Pays de la Loire
        "FR-HDF": '2,240 ‚Ç¨',   // Hauts-de-France
        "FR-BRE": '2,200 ‚Ç¨',   // Bretagne
        "FR-NOR": '2,200 ‚Ç¨',   // Normandie
        "FR-COR": 'Donn√©es non disponibles',   // Corse
        "FR-CVL": 'Donn√©es non disponibles',   // Centre-Val de Loire
      };


      function generateLegend(containerId, data, colorMap, labelFormatter) {
        const container = document.getElementById(containerId);
        container.innerHTML = ""; // Clear previous content

        Object.entries(data).forEach(([regionCode, value]) => {
          const color = colorMap[regionCode] || am5.color(0xd6efff);
          const item = document.createElement("div");
          item.className = "legend-item";

          const colorBox = document.createElement("span");
          colorBox.className = "legend-color";
          colorBox.style.backgroundColor = color.toCSSHex();

          const label = document.createElement("span");
          label.className = "legend-label";
          label.textContent = labelFormatter(regionCode, value);

          item.appendChild(colorBox);
          item.appendChild(label);
          container.appendChild(item);
        });
      }

      generateLegend("studentsLegend", studentsData, manualColorMap, (code, value) => `${regionNames[code]}: ${value}`);
      generateLegend("salaryLegend", salaryData, manualColorMapSalaries, (code, value) => `${regionNames[code]}: ${value}`);

      createFranceMap("studentsChart", studentsData, "√âtudiants");
      createFranceMapSalary("salaryChart", salaryData, "Salaire (‚Ç¨)");
    });
  </script>

  <script>
    // Create root
    am5.ready(function () {
      var root = am5.Root.new("pieChart");
      root._logo.dispose();

      // Set themes
      root.setThemes([am5themes_Animated.new(root)]);

      // Create chart
      var chart = root.container.children.push(
        am5percent.PieChart.new(root, {
          layout: root.horizontalLayout,
          innerRadius: am5.percent(50),
          // paddingLeft: 60
          radius: am5.percent(75), // Make the chart smaller (70% of container)
        })
      );


      // Create series
      var series = chart.series.push(
        am5percent.PieSeries.new(root, {
          name: "Postes",
          valueField: "value",
          categoryField: "category",
          fillField: "color"
        })
      );

      // Set data
      // based on total combination ES 1 - ES 2
      series.data.setAll([
        { category: "Commercial", value: 40, percentage: 38, color: am5.color(0xFFE66D) },
        { category: "Postes non cibl√©s", value: 27, percentage: 26, color: am5.color(0xFBF0EA) },
        { category: "Autres postes cibl√©s", value: 9, percentage: 9, color: am5.color(0xE6AA68) },
        { category: "Responsable commercial", value: 4, percentage: 4, color: am5.color(0xBFD8A4) },
        { category: "Conseiller commercial", value: 24, percentage: 23, color: am5.color(0x7FB069) },
      ]);

      // Add labels
      series.labels.template.setAll({
        text: "{category}: {percentage}%",
        fontSize: 14,
        // fill: am5.color(0x00454D),
        // radius: 3,
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
      });

      // series.ticks.template.set("visible", false);

      // Add spacing between slices
      series.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 10 // Pull each slice slightly outward
      });

      // Customize slices (optional)
      series.slices.template.setAll({
        stroke: am5.color(0xffffff),
        strokeWidth: 2,
        tooltipText: "{category}: {percentage}%",
      });

    }); // end am5.ready()
  </script>

  <script>
    am5.ready(function () {
      var root2 = am5.Root.new("domainePieChart");
      root2._logo.dispose();

      root2.setThemes([am5themes_Animated.new(root2)]);

      var chart2 = root2.container.children.push(
        am5percent.PieChart.new(root2, {
          layout: root2.horizontalLayout,
          innerRadius: am5.percent(50),
          radius: am5.percent(75), // Make the chart smaller (70% of container)
        })
      );

      var series2 = chart2.series.push(
        am5percent.PieSeries.new(root2, {
          valueField: "value",
          categoryField: "category",
          fillField: "color"
        })
      );

      series2.data.setAll([
        { category: "Immobilier", value: 56, percentage: 19, color: am5.color(0x99D17B) },
        { category: "Commerce", value: 9, percentage: 3, color: am5.color(0x95BF8F) },
        { category: "Assurance", value: 6, percentage: 2, color: am5.color(0xB1AE91) },
        { category: "Autre", value: 223, percentage: 76, color: am5.color(0xFBF0EA) },
      ]);

      series2.labels.template.setAll({
        text: "{category}: {percentage}%",
        fontSize: "14px", // Adjust font size if needed
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
      });

      // Add spacing between slices
      series2.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 10 // Pull each slice slightly outward
      });

      series2.slices.template.setAll({
        stroke: am5.color(0xffffff),
        strokeWidth: 2,
        tooltipText: "{category}: {percentage}%",
      });
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("pieChartGender");
      rootGender._logo.dispose();
      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(
        am5percent.PieChart.new(rootGender, {
          layout: rootGender.horizontalLayout,
          innerRadius: am5.percent(50),
          radius: am5.percent(70), // Make the chart smaller (70% of container)
        })
      );

      var seriesGender = chartGender.series.push(
        am5percent.PieSeries.new(rootGender, {
          valueField: "value",
          categoryField: "category"
        })
      );

      seriesGender.labels.template.set("forceHidden", true);

      seriesGender.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ({percentage}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });
      const genderData = [
        { category: "Homme", value: 141, percentage: 44 },
        { category: "Femme", value: 177, percentage: 56 }
      ];
      seriesGender.data.setAll(genderData);

      seriesGender.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("pieChartStatut");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout, // Changed to horizontal layout
        innerRadius: am5.percent(50),
        radius: am5.percent(65), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      // seriesStatut.labels.template.set("forceHidden", true);
      seriesStatut.labels.template.setAll({
        text: "{category} : {percentage}%",
        fontSize: "14px", // Adjust font size if needed
        maxWidth: 125, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
      });

      // Make label text color match slice color
      seriesStatut.labels.template.adapters.add("fill", function (fill, target) {
        if (target.dataItem) {
          return target.dataItem.get("slice").get("fill");
        }
        return fill;
      });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ({percentage}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      seriesStatut.ticks.template.setAll({
        strokeWidth: 2,
      });

      // seriesStatut.ticks.template.set("visible", false);
      seriesStatut.data.setAll([
        { category: "A un emploi", value: 105, percentage: 33, code: 'A' },
        { category: "Recherche", value: 20, percentage: 6, code: 'B' },
        { category: "Poursuit des √©tudes", value: 182, percentage: 57, code: 'C' },
        { category: "Inactif", value: 5, percentage: 2, code: 'D' },
        { category: "Non r√©pondant", value: 6, percentage: 2, code: 'E' }
      ]);

      // Set label colors to match slice colors after data is set
      seriesStatut.onPrivate("maskRectangle", function () {
        seriesStatut.dataItems.forEach(function (dataItem) {
          var label = dataItem.get("label");
          var slice = dataItem.get("slice");
          if (label && slice) {
            label.set("fill", slice.get("fill"));
          }
        });
      });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    // Create root and chart
    var root = am5.Root.new("pieChartContinueStudy");
    root._logo.dispose();

    root.setThemes([
      am5themes_Animated.new(root)
    ]);

    var chart = root.container.children.push(
      am5percent.SlicedChart.new(root, {
        layout: root.horizontalLayout
      })
    );

    // Define data
    var data = [{
      category: "Poursuit des √©tudes",
      value: 182,
      percentage: 57
    }, {
      category: "Ne poursuit pas d'√©tudes",
      value: 136,
      percentage: 43
    }];

    // Create series
    var shape = `M38.022,16.348c0,0.807-0.484,1.534-1.229,1.846l-0.771,0.322v4.43c0,0.552-0.447,1-1,1c-0.554,0-1-0.448-1-1v-3.594
		l-2.312,0.968v5.085c0,0.859-0.554,1.626-1.369,1.896l-10.188,3.386c-0.205,0.068-0.418,0.104-0.632,0.104
		c-0.192,0-0.389-0.028-0.577-0.085L7.736,27.319c-0.845-0.257-1.423-1.033-1.423-1.915v-5.085l-5.084-2.126
		C0.486,17.881,0,17.154,0,16.348c0-0.806,0.484-1.534,1.229-1.845L18.24,7.388c0.491-0.206,1.049-0.206,1.543,0l17.01,7.115
		C37.537,14.813,38.022,15.541,38.022,16.348z`;

    var series = chart.series.push(
      am5percent.PictorialStackedSeries.new(root, {
        name: "Series",
        categoryField: "category",
        valueField: "value",
        orientation: "vertical",
        svgPath: shape,
      })
    );
    series.ticks.template.set("visible", false);
    series.slices.template.setAll({
      cornerRadius: 5,
      shiftRadius: 8,
      tooltipText: "{category}: {value} ({percentage}%)",
      stroke: am5.color("#fff"),
      strokeWidth: 1.5,
    });
    series.data.setAll(data);

    series.labels.template.set("visible", false);
  </script>

  <script>
    // Create root and chart
    var root = am5.Root.new("pieChartSatisfaction");
    root._logo.dispose();

    root.setThemes([
      am5themes_Animated.new(root)
    ]);

    var chart = root.container.children.push(
      am5percent.SlicedChart.new(root, {
        layout: root.horizontalLayout
      })
    );

    // Define data
    var data = [{
      category: "Non Satisfied",
      value: 27,
      percentage: 27
    }, {
      category: "Satisfied",
      value: 73,
      percentage: 73
    }];

    // Create series
    var shape = `M320 1344q0-26-19-45t-45-19q-27 0-45.5 19t-18.5 45q0 27 18.5 45.5t45.5 
        18.5q26 0 45-18.5t19-45.5zm160-512v640q0 26-19 45t-45 19h-288q-26 0-45-19t-19-45v-640q0-26 19-45t45-19h288q26 
        0 45 19t19 45zm1184 0q0 86-55 149 15 44 15 76 3 76-43 137 17 56 0 117-15 57-54 94 9 112-49 181-64 76-197 
        78h-129q-66 0-144-15.5t-121.5-29-120.5-39.5q-123-43-158-44-26-1-45-19.5t-19-44.5v-641q0-25 18-43.5t43-20.5q24-2 
        76-59t101-121q68-87 101-120 18-18 31-48t17.5-48.5 13.5-60.5q7-39 12.5-61t19.5-52 34-50q19-19 45-19 46 0 82.5 
        10.5t60 26 40 40.5 24 45 12 50 5 45 .5 39q0 38-9.5 76t-19 60-27.5 56q-3 6-10 18t-11 22-8 24h277q78 0 135 57t57 135z`;

    var series = chart.series.push(
      am5percent.PictorialStackedSeries.new(root, {
        name: "Series",
        categoryField: "category",
        valueField: "value",
        orientation: "vertical",
        svgPath: shape,
      })
    );
    series.ticks.template.set("visible", false);
    series.slices.template.setAll({
      cornerRadius: 5,
      shiftRadius: 8,
      stroke: am5.color("#fff"),
      strokeWidth: 0.2,
      // Disable tooltip completely
      tooltipText: "",
      // Disable hover states
      cursorOverStyle: "default"
    });

    // Set colors directly in the data
    data[0].color = am5.color("#808080"); // Gray for Satisfied
    data[1].color = am5.color("#1E9180"); // Green for Non Satisfied

    // Configure series to use the color field
    series.set("colors", am5.ColorSet.new(root, {
      colors: [
        am5.color("#808080"), // Gray
        am5.color("#1E9180")  // Green
      ]
    }));

    // Disable hover state color changes
    series.slices.template.states.create("hover", {
      fill: undefined
    });

    series.data.setAll(data);
    series.labels.template.set("visible", false);
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("chartSizeTarget");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout,
        innerRadius: am5.percent(50),
        radius: am5.percent(60), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      // seriesStatut.labels.template.set("forceHidden", true);

      seriesStatut.labels.template.setAll({
        text: "{category} : {percentage}%",
        fontSize: "14px", // Adjust font size if needed
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
      });

      // Make label text color match slice color
      seriesStatut.labels.template.adapters.add("fill", function (fill, target) {
        if (target.dataItem) {
          return target.dataItem.get("slice").get("fill");
        }
        return fill;
      });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ({percentage}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      seriesStatut.ticks.template.setAll({
        strokeWidth: 2,
      });

      // seriesStatut.ticks.template.set("visible", false);
      seriesStatut.data.setAll([
        { category: "Tr√®s petite entreprise : 1 √† 9", value: 60, percentage: 27, code: 'A' },
        { category: "Moyenne entreprise : 50 √† 499", value: 53, percentage: 24, code: 'B' },
        { category: "Petite entreprise : 10 √† 49", value: 38, percentage: 17, code: 'C' },
        { category: "Tr√®s grande entreprise : 1000 et +", value: 40, percentage: 18, code: 'D' },
        { category: "Grande entreprise : 500 √† 999", value: 17, percentage: 7, code: 'E' },
        { category: "Micro entreprise : 0", value: 16, percentage: 7, code: 'F' },
      ]);

      // Set label colors to match slice colors after data is set
      seriesStatut.onPrivate("maskRectangle", function () {
        seriesStatut.dataItems.forEach(function (dataItem) {
          var label = dataItem.get("label");
          var slice = dataItem.get("slice");
          if (label && slice) {
            label.set("fill", slice.get("fill"));
          }
        });
      });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("chartSizeNonTarget");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout,
        innerRadius: am5.percent(50),
        radius: am5.percent(60), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      // seriesStatut.labels.template.set("forceHidden", true);

      seriesStatut.labels.template.setAll({
        text: "{category} : {percentage}%",
        fontSize: "14px", // Adjust font size if needed
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
        // radius: am5.percent(110), // Position labels further outside
      });

      // Make label text color match slice color
      seriesStatut.labels.template.adapters.add("fill", function (fill, target) {
        if (target.dataItem) {
          return target.dataItem.get("slice").get("fill");
        }
        return fill;
      });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ({percentage}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      seriesStatut.ticks.template.setAll({
        strokeWidth: 2,
      });

      // seriesStatut.ticks.template.set("visible", false);
      seriesStatut.data.setAll([
        { category: "Tr√®s petite entreprise : 1 √† 9", value: 12, percentage: 18, code: 'A' },
        { category: "Moyenne entreprise : 50 √† 499", value: 12, percentage: 18, code: 'B' },
        { category: "Petite entreprise : 10 √† 49", value: 22, percentage: 32, code: 'C' },
        { category: "Tr√®s grande entreprise : 1000 et +", value: 9, percentage: 13, code: 'D' },
        { category: "Grande entreprise : 500 √† 999", value: 7, percentage: 10, code: 'E' },
        { category: "Micro entreprise : 0", value: 6, percentage: 9, code: 'F' },
      ]);

      // Set label colors to match slice colors after data is set
      seriesStatut.onPrivate("maskRectangle", function () {
        seriesStatut.dataItems.forEach(function (dataItem) {
          var label = dataItem.get("label");
          var slice = dataItem.get("slice");
          if (label && slice) {
            label.set("fill", slice.get("fill"));
          }
        });
      });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("chartSkillTarget");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout, // Changed to horizontal layout
        innerRadius: am5.percent(50),
        radius: am5.percent(60), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      // Configure labels to show outside with more space
      seriesStatut.labels.template.setAll({
        text: "{category} : {percentage}%",
        fontSize: "13px", // Adjust font size if needed
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
        // radius: am5.percent(110), // Position labels further outside
      });

      // Make label text color match slice color
      seriesStatut.labels.template.adapters.add("fill", function (fill, target) {
        if (target.dataItem) {
          return target.dataItem.get("slice").get("fill");
        }
        return fill;
      });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {percentage}%",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      seriesStatut.ticks.template.setAll({
        strokeWidth: 2,
      });

      seriesStatut.data.setAll([
        { category: "Participation in the definition of commercial objectives", value: 11, percentage: 10, code: 'A' },
        { category: "Implementation of sales support tools", value: 10, percentage: 9, code: 'B' },
        { category: "Analysis of performance indicators", value: 9, percentage: 9, code: 'C' },
        { category: "Identification of business development opportunities", value: 8, percentage: 8, code: 'D' },
        { category: "Participation in the development of individual and collective objectives", value: 8, percentage: 8, code: 'E' },
        { category: "Autre", value: 59, percentage: 56, code: 'F' },
      ]);

      // Set label colors to match slice colors after data is set
      seriesStatut.onPrivate("maskRectangle", function () {
        seriesStatut.dataItems.forEach(function (dataItem) {
          var label = dataItem.get("label");
          var slice = dataItem.get("slice");
          if (label && slice) {
            label.set("fill", slice.get("fill"));
          }
        });
      });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("chartSkillNonTarget");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout, // Changed to horizontal layout
        innerRadius: am5.percent(50),
        radius: am5.percent(60), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      // seriesStatut.labels.template.set("forceHidden", true);

      // Configure labels to show outside with more space
      seriesStatut.labels.template.setAll({
        text: "{category} : {percentage}%",
        fontSize: "13px", // Adjust font size if needed
        maxWidth: 150, // Set maximum width for labels
        oversizedBehavior: "wrap", // Wrap long text
        paddingBottom: 20,
        // radius: am5.percent(110), // Position labels further outside
      });

      // Make label text color match slice color
      seriesStatut.labels.template.adapters.add("fill", function (fill, target) {
        if (target.dataItem) {
          return target.dataItem.get("slice").get("fill");
        }
        return fill;
      });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {percentage}%",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      seriesStatut.ticks.template.setAll({
        strokeWidth: 2,
      });

      // seriesStatut.ticks.template.set("visible", false);
      seriesStatut.data.setAll([
        { category: "Participation in the definition of commercial objectives", value: 5, percentage: 10, code: 'A' },
        { category: "Definition of performance indicators for commercial policy", value: 4, percentage: 9, code: 'B' },
        { category: "Implementation of sales support tools", value: 3, percentage: 9, code: 'C' },
        { category: "Participation in the development of individual and collective objectives", value: 3, percentage: 9, code: 'D' },
        { category: "Development of dashboards", value: 3, percentage: 9, code: 'E' },
        { category: "Autre", value: 21, percentage: 54, code: 'F' },
      ]);

      // Set label colors to match slice colors after data is set
      seriesStatut.onPrivate("maskRectangle", function () {
        seriesStatut.dataItems.forEach(function (dataItem) {
          var label = dataItem.get("label");
          var slice = dataItem.get("slice");
          if (label && slice) {
            label.set("fill", slice.get("fill"));
          }
        });
      });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      var rootGender = am5.Root.new("pieChartSameSchool");
      rootGender._logo.dispose();

      rootGender.setThemes([am5themes_Animated.new(rootGender)]);

      var chartGender = rootGender.container.children.push(am5percent.PieChart.new(rootGender, {
        layout: rootGender.horizontalLayout,
        innerRadius: am5.percent(50),
        radius: am5.percent(75), // Make the chart smaller (70% of container)
      }));

      var seriesStatut = chartGender.series.push(am5percent.PieSeries.new(rootGender, {
        valueField: "value",
        categoryField: "category"
      }));

      seriesStatut.labels.template.set("forceHidden", true);

      // seriesStatut.labels.template.setAll({
      //   text: "{category} : {percentage}%",
      //   fontSize: "13px", // Adjust font size if needed
      //   maxWidth: 150, // Set maximum width for labels
      //   oversizedBehavior: "wrap", // Wrap long text
      //   paddingBottom: 20,
      // });

      // // Make label text color match slice color
      // seriesStatut.labels.template.adapters.add("fill", function(fill, target) {
      //   if (target.dataItem) {
      //     return target.dataItem.get("slice").get("fill");
      //   }
      //   return fill;
      // });

      seriesStatut.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ({percentage}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
      });

      // seriesStatut.ticks.template.setAll({
      //   strokeWidth: 2,
      // });

      // seriesStatut.ticks.template.set("visible", false);
      seriesStatut.data.setAll([
        { category: "Meme ecole", value: 86, percentage: 47, code: 'A' },
        { category: "Ecole differente", value: 97, percentage: 53, code: 'B' },
      ]);

      // // Set label colors to match slice colors after data is set
      // seriesStatut.onPrivate("maskRectangle", function() {
      //   seriesStatut.dataItems.forEach(function(dataItem) {
      //     var label = dataItem.get("label");
      //     var slice = dataItem.get("slice");
      //     if (label && slice) {
      //       label.set("fill", slice.get("fill"));
      //     }
      //   });
      // });

      seriesStatut.appear(1000, 100);
    });
  </script>

  <script>
    am5.ready(function () {
      // Create root
      var root = am5.Root.new("pieChartTopSalaries");

      // Set theme
      root.setThemes([
        am5themes_Animated.new(root)
      ]);

      // Create chart
      var chart = root.container.children.push(
        am5percent.PieChart.new(root, {
          layout: root.verticalLayout
        })
      );

      // Create series
      var series = chart.series.push(
        am5percent.PieSeries.new(root, {
          valueField: "value",
          categoryField: "category"
        })
      );

      series.labels.template.set("forceHidden", true);

      series.slices.template.setAll({
        cornerRadius: 5,
        shiftRadius: 8,
        tooltipText: "{category}: {value} ‚Ç¨ ({valuePercentTotal.formatNumber('#.#')}%)",
        stroke: am5.color("#fff"),
        strokeWidth: 1.5,
        cornerRadius: 6
      });

      // Data for Top 3 Regions by Salary
      const topSalaryData = [
        { category: "√éle-de-France", value: 3100 },
        { category: "Provence-Alpes-C√¥te d'Azur", value: 2700 },
        { category: "Auvergne-Rh√¥ne-Alpes", value: 2600 }
      ];
      series.data.setAll(topSalaryData);

      // Create and configure legend
      const legend = am5.Legend.new(root, {
        nameField: "category",
        valueText: "{value} ‚Ç¨",
        layout: am5.VerticalLayout.new(root),
        centerX: am5.p50,
        x: am5.p50,
        width: am5.percent(100),
        height: am5.percent(100)
      });

      // Legend appearance improvements
      legend.labels.template.setAll({
        fontSize: 14,               // bigger font
        fontWeight: "600",          // bolder
        fill: am5.color("#222222"), // darker text for contrast
        oversizedBehavior: "wrap",
        paddingTop: 4,
        paddingBottom: 4,
      });

      legend.markers.template.setAll({
        width: 18,   // larger markers
        height: 18,
        cornerRadius: 3,
      });

      legend.items.template.setAll({
        paddingTop: 6,
        paddingBottom: 6,
        gap: 10,
      });

      // Link legend to data
      legend.data.setAll(series.dataItems);

      // Move legend to external container
      const legendContainer = document.getElementById("pieChartTopSalariesLegend");
      legendContainer.style.maxHeight = "200px";      // limit height
      legendContainer.style.overflowY = "auto";       // scroll if too tall
      legendContainer.style.width = "300px";           // fixed width for better layout
      legendContainer.style.background = "#fafafa";    // subtle background to improve visibility
      legendContainer.style.border = "1px solid #ddd"; // subtle border
      legendContainer.style.padding = "10px";          // padding inside

      legendContainer.appendChild(legend.dom);

      // Animate chart
      series.appear(1000, 100);
    });
  </script>

  <script>
    var root = am5.Root.new("chartdivSankee");
    root._logo.dispose();
    // Set themes
    // https://www.amcharts.com/docs/v5/concepts/themes/
    root.setThemes([am5themes_Animated.new(root)]);

    // Create series
    // https://www.amcharts.com/docs/v5/charts/flow-charts/
    var series = root.container.children.push(
      am5flow.Sankey.new(root, {
        sourceIdField: "from",
        targetIdField: "to",
        valueField: "value",
        paddingRight: 170,
        idField: "id"
      })
    );

    series.links.template.setAll({ fillStyle: "solid", fillOpacity: 0.15 });

    // highlight all links with the same id beginning
    series.links.template.events.on("pointerover", function (event) {
      var dataItem = event.target.dataItem;
      var id = dataItem.get("id").split("-")[0];

      am5.array.each(series.dataItems, function (dataItem) {
        if (dataItem.get("id").indexOf(id) != -1) {
          dataItem.get("link").hover();
        }
      });
    });

    series.links.template.events.on("pointerout", function (event) {
      am5.array.each(series.dataItems, function (dataItem) {
        dataItem.get("link").unhover();
      });
    });

    // Set data
    // https://www.amcharts.com/docs/v5/charts/flow-charts/#Setting_data
    series.data.setAll([
      { from: "Dipl√¥m√©", to: "EE1 Recherche", value: 140, id: "A0-0" },
      { from: "Dipl√¥m√©", to: "EE1 Poursuit des √©tudes", value: 178, id: "A1-0" },

      // ES 1
      { from: "EE1 Recherche", to: "EE2 Non r√©pondant", value: 6, id: "B0-1" },
      { from: "EE1 Recherche", to: "EE2 Inactif", value: 5, id: "B1-1" },
      { from: "EE1 Recherche", to: "EE2 A un emploi", value: 105, id: "B2-1" },
      { from: "EE1 Recherche", to: "EE2 Recherche", value: 20, id: "B3-1" },
      { from: "EE1 Recherche", to: "EE2 Poursuit des √©tudes", value: 4, id: "B4-1" },

      { from: "EE1 Poursuit des √©tudes", to: "EE2 Poursuit des √©tudes", value: 178, id: "C0-1" },

      // ES 2
      { from: "EE2 Non r√©pondant", to: "EE3 Non r√©pondant", value: 6, id: "D0-2" },

      { from: "EE2 Inactif", to: "EE3 Non r√©pondant", value: 2, id: "E0-2" },
      { from: "EE2 Inactif", to: "EE3 Inactif", value: 3, id: "E1-2" },

      { from: "EE2 A un emploi", to: "EE3 A un emploi", value: 95, id: "F0-2" },
      { from: "EE2 A un emploi", to: "EE3 Non r√©pondant", value: 10, id: "F1-2" },

      { from: "EE2 Recherche", to: "EE3 Recherche", value: 12, id: "G0-2" },
      { from: "EE2 Recherche", to: "EE3 Poursuit des √©tudes", value: 5, id: "G1-2" },
      { from: "EE2 Recherche", to: "EE3 Non r√©pondant", value: 3, id: "G2-2" },

      { from: "EE2 Poursuit des √©tudes", to: "EE3 Poursuit des √©tudes", value: 182, id: "H0-2" },

      // ES 3
      { from: "EE3 Non r√©pondant", to: "EE4 Non r√©pondant", value: 21, id: "I0-3" },

      { from: "EE3 Inactif", to: "EE4 Inactif", value: 3, id: "J0-3" },

      { from: "EE3 A un emploi", to: "EE4 A un emploi", value: 95, id: "K0-3" },

      { from: "EE3 Recherche", to: "EE4 Recherche", value: 4, id: "L0-3" },
      { from: "EE3 Recherche", to: "EE4 Non r√©pondant", value: 4, id: "L1-3" },
      { from: "EE3 Recherche", to: "EE4 Poursuit des √©tudes", value: 4, id: "L2-3" },

      { from: "EE3 Poursuit des √©tudes", to: "EE4 Poursuit des √©tudes", value: 187, id: "M0-3" },

      // ES 4
      { from: "EE4 Non r√©pondant", to: "Fin de l'enqu√™te", value: 25, id: "N0-4" },
      { from: "EE4 Inactif", to: "Fin de l'enqu√™te", value: 3, id: "N1-4" },
      { from: "EE4 A un emploi", to: "Fin de l'enqu√™te", value: 95, id: "N2-4" },
      { from: "EE4 Recherche", to: "Fin de l'enqu√™te", value: 4, id: "N3-4" },
      { from: "EE4 Poursuit des √©tudes", to: "Fin de l'enqu√™te", value: 191, id: "N4-4" },

    ]);

    series.appear(1000, 100);
  </script>

  <!-- Script chart for sorted data preview -->
  <script>
    var root1 = am5.Root.new("previewContinueStudyBar");
    root1._logo.dispose();

    // Set themes
    root1.setThemes([
      am5themes_Animated.new(root1)
    ]);

    // Create chart
    var chart1 = root1.container.children.push(am5xy.XYChart.new(root1, {
      panX: false,
      panY: false,
      wheelX: "none",
      wheelY: "none",
      paddingLeft: 0
    }));

    // We don't want zoom-out button to appear while animating, so we hide it
    chart1.zoomOutButton.set("forceHidden", true);

    // Create axes
    var yRenderer1 = am5xy.AxisRendererY.new(root1, {
      minGridDistance: 30,
      minorGridEnabled: true
    });

    yRenderer1.grid.template.set("location", 1);

    var yAxis1 = chart1.yAxes.push(am5xy.CategoryAxis.new(root1, {
      maxDeviation: 0,
      categoryField: "network",
      renderer: yRenderer1,
      tooltip: am5.Tooltip.new(root1, { themeTags: ["axis"] })
    }));

    var xAxis1 = chart1.xAxes.push(am5xy.ValueAxis.new(root1, {
      maxDeviation: 0,
      min: 0,
      numberFormatter: am5.NumberFormatter.new(root1, {
        "numberFormat": "#,###a"
      }),
      extraMax: 0.1,
      renderer: am5xy.AxisRendererX.new(root1, {
        strokeOpacity: 0.1,
        minGridDistance: 80
      })
    }));

    // Add series
    var series1 = chart1.series.push(am5xy.ColumnSeries.new(root1, {
      name: "Series 1",
      xAxis: xAxis1,
      yAxis: yAxis1,
      valueXField: "value",
      categoryYField: "network",
      tooltip: am5.Tooltip.new(root1, {
        pointerOrientation: "left",
        labelText: "{valueX}"
      })
    }));

    // Rounded corners for columns
    series1.columns.template.setAll({
      cornerRadiusTR: 5,
      cornerRadiusBR: 5,
      strokeOpacity: 0
    });

    // Make each column to be of a different color
    series1.columns.template.adapters.add("fill", function (fill, target) {
      return chart1.get("colors").getIndex(series1.columns.indexOf(target));
    });

    series1.columns.template.adapters.add("stroke", function (stroke, target) {
      return chart1.get("colors").getIndex(series1.columns.indexOf(target));
    });

    // Set data
    var data1 = [
      {
        "network": "Poursuit des √©tudes",
        "value": 182
      },
      {
        "network": "A un emploi",
        "value": 105
      },
      {
        "network": "Recherche",
        "value": 20
      },
      {
        "network": "Inactif",
        "value": 5
      },
      {
        "network": "Non r√©pondant",
        "value": 6
      },
    ];

    yAxis1.data.setAll(data1);
    series1.data.setAll(data1);
    sortCategoryAxis1();

    // Get series item by category
    function getSeriesItem1(category) {
      for (var i = 0; i < series1.dataItems.length; i++) {
        var dataItem = series1.dataItems[i];
        if (dataItem.get("categoryY") == category) {
          return dataItem;
        }
      }
    }

    chart1.set("cursor", am5xy.XYCursor.new(root1, {
      behavior: "none",
      xAxis: xAxis1,
      yAxis: yAxis1
    }));

    // Axis sorting
    function sortCategoryAxis1() {
      // Sort by value
      series1.dataItems.sort(function (x, y) {
        return x.get("valueX") - y.get("valueX"); // descending
      });

      // Go through each axis item
      am5.array.each(yAxis1.dataItems, function (dataItem) {
        // get corresponding series item
        var seriesDataItem = getSeriesItem1(dataItem.get("category"));

        if (seriesDataItem) {
          // get index of series data item
          var index = series1.dataItems.indexOf(seriesDataItem);
          // calculate delta position
          var deltaPosition = (index - dataItem.get("index", 0)) / series1.dataItems.length;
          // set index to be the same as series data item index
          dataItem.set("index", index);
          // set deltaPosition instanlty
          dataItem.set("deltaPosition", -deltaPosition);
          // animate delta position to 0
          dataItem.animate({
            key: "deltaPosition",
            to: 0,
            duration: 1000,
            easing: am5.ease.out(am5.ease.cubic)
          });
        }
      });

      // Sort axis items by index.
      yAxis1.dataItems.sort(function (x, y) {
        return x.get("index") - y.get("index");
      });
    }

    series1.appear(1000);
    chart1.appear(1000, 100);
  </script>

  <script>
    var root2 = am5.Root.new("previewJobTargeted");
    root2._logo.dispose();

    // Set themes
    root2.setThemes([
      am5themes_Animated.new(root2)
    ]);

    // Create chart
    var chart2 = root2.container.children.push(am5xy.XYChart.new(root2, {
      panX: false,
      panY: false,
      wheelX: "none",
      wheelY: "none",
      paddingLeft: 0
    }));

    // We don't want zoom-out button to appear while animating, so we hide it
    chart2.zoomOutButton.set("forceHidden", true);

    // Create axes
    var yRenderer2 = am5xy.AxisRendererY.new(root2, {
      minGridDistance: 30,
      minorGridEnabled: true
    });

    yRenderer2.grid.template.set("location", 1);

    var yAxis2 = chart2.yAxes.push(am5xy.CategoryAxis.new(root2, {
      maxDeviation: 0,
      categoryField: "network",
      renderer: yRenderer2,
      tooltip: am5.Tooltip.new(root2, { themeTags: ["axis"] })
    }));

    var xAxis2 = chart2.xAxes.push(am5xy.ValueAxis.new(root2, {
      maxDeviation: 0,
      min: 0,
      numberFormatter: am5.NumberFormatter.new(root2, {
        "numberFormat": "#,###a"
      }),
      extraMax: 0.1,
      renderer: am5xy.AxisRendererX.new(root2, {
        strokeOpacity: 0.1,
        minGridDistance: 80
      })
    }));

    // Add series
    var series2 = chart2.series.push(am5xy.ColumnSeries.new(root2, {
      name: "Series 1",
      xAxis: xAxis2,
      yAxis: yAxis2,
      valueXField: "value",
      categoryYField: "network",
      tooltip: am5.Tooltip.new(root2, {
        pointerOrientation: "left",
        labelText: "{valueX}"
      })
    }));

    // Rounded corners for columns
    series2.columns.template.setAll({
      cornerRadiusTR: 5,
      cornerRadiusBR: 5,
      strokeOpacity: 0
    });

    // Make each column to be of a different color
    series2.columns.template.adapters.add("fill", function (fill, target) {
      return chart2.get("colors").getIndex(series2.columns.indexOf(target));
    });

    series2.columns.template.adapters.add("stroke", function (stroke, target) {
      return chart2.get("colors").getIndex(series2.columns.indexOf(target));
    });

    // Set data
    var dataJobTargeted = [
      {
        "network": "Autre",
        "value": 27
      },
      {
        "network": "Responsable de rayon/ d'univers",
        "value": 1
      },
      {
        "network": "Conseiller commercial",
        "value": 24
      },
      {
        "network": "Commercial",
        "value": 40
      },
      {
        "network": "Charg√© de communication",
        "value": 1
      },
      {
        "network": "Responsable des ventes",
        "value": 1
      },
      {
        "network": "Chef de secteur",
        "value": 3
      },
      {
        "network": "Attach√© commercial",
        "value": 3
      },
      {
        "network": "Responsable commercial",
        "value": 4
      },
      {
        "network": "Chef de projets marketing",
        "value": 0
      }
    ];

    yAxis2.data.setAll(dataJobTargeted);
    series2.data.setAll(dataJobTargeted);
    sortCategoryAxis2();

    // Get series item by category
    function getSeriesItem2(category) {
      for (var i = 0; i < series2.dataItems.length; i++) {
        var dataItem = series2.dataItems[i];
        if (dataItem.get("categoryY") == category) {
          return dataItem;
        }
      }
    }

    chart2.set("cursor", am5xy.XYCursor.new(root2, {
      behavior: "none",
      xAxis: xAxis2,
      yAxis: yAxis2
    }));

    // Axis sorting
    function sortCategoryAxis2() {
      // Sort by value
      series2.dataItems.sort(function (x, y) {
        return x.get("valueX") - y.get("valueX"); // descending
      });

      // Go through each axis item
      am5.array.each(yAxis2.dataItems, function (dataItem) {
        // get corresponding series item
        var seriesDataItem = getSeriesItem2(dataItem.get("category"));

        if (seriesDataItem) {
          // get index of series data item
          var index = series2.dataItems.indexOf(seriesDataItem);
          // calculate delta position
          var deltaPosition = (index - dataItem.get("index", 0)) / series2.dataItems.length;
          // set index to be the same as series data item index
          dataItem.set("index", index);
          // set deltaPosition instanlty
          dataItem.set("deltaPosition", -deltaPosition);
          // animate delta position to 0
          dataItem.animate({
            key: "deltaPosition",
            to: 0,
            duration: 1000,
            easing: am5.ease.out(am5.ease.cubic)
          });
        }
      });

      // Sort axis items by index.
      yAxis2.dataItems.sort(function (x, y) {
        return x.get("index") - y.get("index");
      });
    }

    series2.appear(1000);
    chart2.appear(1000, 100);
  </script>

  <script>
    function openModal() {
      const modal = document.getElementById('infoModal');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeModal(event) {
      // Close only if clicking on the modal background or close button
      if (!event || event.target === document.getElementById('infoModal') || event.target.closest('.close-button')) {
        const modal = document.getElementById('infoModal');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto'; // Restore scrolling
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModal();
      }
    });
  </script>

  <script>
    function openModalScope() {
      const modal = document.getElementById('infoModalScope');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeModalScope(event) {
      // Close only if clicking on the modal background or close button
      if (!event || event.target === document.getElementById('infoModalScope') || event.target.closest('.close-button')) {
        const modal = document.getElementById('infoModalScope');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto'; // Restore scrolling
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModalScope();
      }
    });
  </script>

  <script>
    function openModalScopeManagerial() {
      const modal = document.getElementById('infoModalScopeManagerial');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeModalScopeManagerial(event) {
      // Close only if clicking on the modal background or close button
      if (!event || event.target === document.getElementById('infoModalScopeManagerial') || event.target.closest('.close-button')) {
        const modal = document.getElementById('infoModalScopeManagerial');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto'; // Restore scrolling
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModalScopeManagerial();
      }
    });
  </script>

  <script>
    function openModalScopeEmploi() {
      const modal = document.getElementById('infoModalScopeEmploi');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeModalScopeEmploi(event) {
      // Close only if clicking on the modal background or close button
      if (!event || event.target === document.getElementById('infoModalScopeEmploi') || event.target.closest('.close-button')) {
        const modal = document.getElementById('infoModalScopeEmploi');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto'; // Restore scrolling
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModalScopeEmploi();
      }
    });
  </script>

  <script>
    function openModalJobTargeted() {
      const modal = document.getElementById('infoModalJobTargeted');
      modal.classList.add('show');
      document.body.style.overflow = 'hidden'; // Prevent background scrolling
    }

    function closeModalJobTargeted(event) {
      // Close only if clicking on the modal background or close button
      if (!event || event.target === document.getElementById('infoModalJobTargeted') || event.target.closest('.close-button')) {
        const modal = document.getElementById('infoModalJobTargeted');
        modal.classList.remove('show');
        document.body.style.overflow = 'auto'; // Restore scrolling
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', function (event) {
      if (event.key === 'Escape') {
        closeModalJobTargeted();
      }
    });
  </script>
  <script>
    // Hierarchical data structure for sources
    const sourceData = {
      "RDC 2021": [],
      "RDC 2022": ["Classe 2022", "Classe Excellence 2022"],
      "RDC 2023": [],
      "RDC 2024": [],
      "RDC 2025": [],
      "Classe 2022": [],
      "Classe Excellence 2022": [],
      "CDRH 2022": [],
      "CDRH 2023": [],
      "CDRH 2024": [],
      "CDRH 2025": [],
      "CPEB 2021": [],
      "CPEB 2022": [],
      "CPEB 2023": [],
      "CPEB 2024": [],
      "CPEB 2025": []
    };

    // Flat array for easy filtering
    const flatSourceData = Object.keys(sourceData);

    // Static data for sections
    const sectionsData = [
      "Global",
      "Origine scolaire / prof.",
      "Poursuite d'√©tudes",
      "Emploi",
      "Comp√©tences",
      "D√©mographique",
      "Parcours (journey sankey)"
    ];

    // Default selections
    const defaultSelectedSources = [];
    const defaultSelectedSections = [
      "Global",
      "Poursuite d'√©tudes",
      "Emploi",
      "Comp√©tences",
      "D√©mographique",
      "Parcours (journey sankey)"
    ];

    // Track expanded parent items
    let expandedParents = new Set();

    // Initialize the sidebar
    function initializeSidebar() {
      populateSourceCheckboxes();
      populateSectionCheckboxes();
      setupTypeahead();
      setDefaultSelections();
    }

    // Populate source checkboxes - hierarchical structure
    function populateSourceCheckboxes() {
      const container = document.getElementById('sourceCheckboxList');
      container.innerHTML = '';

      // Add Select All checkbox
      const selectAllItem = createSelectAllCheckbox();
      selectAllItem.classList.add('hidden');
      container.appendChild(selectAllItem);

      // Add parent items
      Object.keys(sourceData).forEach((source, index) => {
        if (sourceData[source].length === 0 || !sourceData[source]) {
          // Simple item without children
          const item = createCheckboxItem(source, `source_${index}`, 'source', false);
          item.classList.add('hidden');
          container.appendChild(item);
        } else {
          // Parent item with children
          const parentItem = createParentCheckboxItem(source, `source_parent_${index}`, 'source');
          parentItem.classList.add('hidden');
          container.appendChild(parentItem);

          // Add child items
          sourceData[source].forEach((child, childIndex) => {
            const childItem = createChildCheckboxItem(child, `source_child_${index}_${childIndex}`, 'source', source);
            childItem.classList.add('hidden');
            container.appendChild(childItem);
          });
        }
      });
    }

    // Create Select All checkbox
    function createSelectAllCheckbox() {
      const div = document.createElement('div');
      div.className = 'checkbox-item select-all';
      div.innerHTML = `
              <input type="checkbox" id="source_select_all" onchange="toggleSelectAll()">
              <label for="source_select_all">S√©lectionner tout</label>
          `;
      return div;
    }

    // Create parent checkbox item
    function createParentCheckboxItem(text, id, type) {
      const div = document.createElement('div');
      div.className = 'checkbox-item parent-item';
      div.innerHTML = `
              <input type="checkbox" id="${id}" onchange="toggleParent('${text}', '${type}')">
              <label for="${id}">${text}</label>
              <button class="expand-toggle" onclick="toggleExpand('${text}')">‚ñº</button>
          `;
      return div;
    }

    // Create child checkbox item
    function createChildCheckboxItem(text, id, type, parent) {
      const div = document.createElement('div');
      div.className = 'checkbox-item child-item';
      div.dataset.parent = parent;
      div.innerHTML = `
              <input type="checkbox" id="${id}" onchange="updateCount('${type}')" checked>
              <label for="${id}">${text}</label>
          `;
      // Initially hide child items
      div.style.display = 'none';
      return div;
    }

    // Create regular checkbox item
    function createCheckboxItem(text, id, type, isDefaultChecked = false) {
      const div = document.createElement('div');
      div.className = 'checkbox-item';
      const checkedAttribute = isDefaultChecked ? 'checked' : '';
      div.innerHTML = `
              <input type="checkbox" id="${id}" ${checkedAttribute} onchange="updateCount('${type}')">
              <label for="${id}">${text}</label>
          `;
      return div;
    }

    // Toggle parent selection and show/hide children
    function toggleParent(parentName, type) {
      const parentCheckbox = document.querySelector(`input[onchange*="toggleParent('${parentName}'"]`);
      const isChecked = parentCheckbox.checked;
      const childItems = document.querySelectorAll(`[data-parent="${parentName}"]`);

      if (isChecked) {
        // Show child items and expand
        expandedParents.add(parentName);
        childItems.forEach(item => {
          item.style.display = 'flex';
          const checkbox = item.querySelector('input[type="checkbox"]');
          checkbox.checked = true; // Default all child items to checked
        });
        updateExpandIcon(parentName, true);
      } else {
        // Hide child items and collapse
        expandedParents.delete(parentName);
        childItems.forEach(item => {
          item.style.display = 'none';
          const checkbox = item.querySelector('input[type="checkbox"]');
          checkbox.checked = false;
        });
        updateExpandIcon(parentName, false);
      }
      updateCount(type);
    }

    // Toggle expand/collapse of parent items
    function toggleExpand(parentName) {
      const childItems = document.querySelectorAll(`[data-parent="${parentName}"]`);
      const isExpanded = expandedParents.has(parentName);
      const parentCheckbox = document.querySelector(`input[onchange*="toggleParent('${parentName}'"]`);

      if (isExpanded) {
        // Collapse
        expandedParents.delete(parentName);
        childItems.forEach(item => {
          item.style.display = 'none';
        });
        updateExpandIcon(parentName, false);
      } else {
        // Expand only if parent is checked
        if (parentCheckbox.checked) {
          expandedParents.add(parentName);
          childItems.forEach(item => {
            item.style.display = 'flex';
          });
          updateExpandIcon(parentName, true);
        }
      }
    }

    // Update expand icon
    function updateExpandIcon(parentName, isExpanded) {
      const parentItem = document.querySelector(`input[onchange*="toggleParent('${parentName}'"]`).closest('.checkbox-item');
      const expandButton = parentItem.querySelector('.expand-toggle');
      expandButton.textContent = isExpanded ? '‚ñ≤' : '‚ñº';
    }

    // Toggle Select All functionality
    function toggleSelectAll() {
      const selectAllCheckbox = document.getElementById('source_select_all');
      const isChecked = selectAllCheckbox.checked;
      const allCheckboxes = document.querySelectorAll('#sourceCheckboxList input[type="checkbox"]:not(#source_select_all)');
      const visibleCheckboxes = document.querySelectorAll('#sourceCheckboxList .checkbox-item:not(.hidden) input[type="checkbox"]:not(#source_select_all)');

      visibleCheckboxes.forEach(checkbox => {
        checkbox.checked = isChecked;

        // Handle parent-child relationships
        const item = checkbox.closest('.checkbox-item');
        if (item.classList.contains('parent-item')) {
          const parentName = checkbox.closest('.checkbox-item').querySelector('label').textContent;
          const childItems = document.querySelectorAll(`[data-parent="${parentName}"]`);

          if (isChecked) {
            expandedParents.add(parentName);
            childItems.forEach(childItem => {
              childItem.style.display = 'flex';
              childItem.querySelector('input[type="checkbox"]').checked = true;
            });
            updateExpandIcon(parentName, true);
          } else {
            expandedParents.delete(parentName);
            childItems.forEach(childItem => {
              childItem.style.display = 'none';
              childItem.querySelector('input[type="checkbox"]').checked = false;
            });
            updateExpandIcon(parentName, false);
          }
        }
      });

      updateCount('source');
    }

    // Populate section checkboxes
    function populateSectionCheckboxes() {
      const container = document.getElementById('sectionsCheckboxList');
      container.innerHTML = '';

      sectionsData.forEach((section, index) => {
        const isDefaultChecked = defaultSelectedSections.includes(section);
        const item = createCheckboxItem(section, `section_${index}`, 'section', isDefaultChecked);
        container.appendChild(item);
      });
    }

    // Set default selections
    function setDefaultSelections() {
      // Set default section selections
      updateCount('section');
      updateCount('source');
    }

    // Setup typeahead functionality
    function setupTypeahead() {
      const input = document.getElementById('sourceTypeahead');
      input.addEventListener('input', filterSources);
    }

    // Filter sources - empty list initially, show filtered results after 2+ characters
    function filterSources() {
      const input = document.getElementById('sourceTypeahead');
      const filter = input.value.toLowerCase();
      const items = document.querySelectorAll('#sourceCheckboxList .checkbox-item');

      // If less than 2 characters, hide all items
      if (filter.length < 2) {
        items.forEach(item => {
          item.classList.add('hidden');
        });
        return;
      }

      // Show Select All when filtering
      const selectAllItem = document.getElementById('source_select_all').closest('.checkbox-item');
      selectAllItem.classList.remove('hidden');

      // Show filtered items when 2 or more characters are typed
      items.forEach(item => {
        if (item.classList.contains('select-all')) return;

        const label = item.querySelector('label').textContent.toLowerCase();
        if (label.includes(filter)) {
          item.classList.remove('hidden');

          // If this is a parent item and it's checked, show its children
          if (item.classList.contains('parent-item')) {
            const parentName = item.querySelector('label').textContent;
            const parentCheckbox = item.querySelector('input[type="checkbox"]');
            if (parentCheckbox.checked && expandedParents.has(parentName)) {
              const childItems = document.querySelectorAll(`[data-parent="${parentName}"]`);
              childItems.forEach(childItem => {
                childItem.classList.remove('hidden');
                childItem.style.display = 'flex';
              });
            }
          }
        } else {
          item.classList.add('hidden');
          // Hide child items if parent is hidden
          if (item.classList.contains('child-item')) {
            item.style.display = 'none';
          }
        }
      });
    }

    // Update selected count
    function updateCount(type) {
      const container = type === 'source' ? '#sourceCheckboxList' : '#sectionsCheckboxList';
      const countElement = type === 'source' ? 'sourceCount' : 'sectionsCount';
      const checkboxes = document.querySelectorAll(`${container} input[type="checkbox"]:checked:not(#source_select_all)`);

      const count = checkboxes.length;
      const text = type === 'source' ? 'source(s) s√©lectionn√©e(s)' : 'section(s) s√©lectionn√©e(s)';
      document.getElementById(countElement).textContent = `${count} ${text}`;
    }

    // Clear source filters
    function clearSourceFilters() {
      document.getElementById('sourceTypeahead').value = '';
      document.querySelectorAll('#sourceCheckboxList input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
      });
      // Hide all child items
      document.querySelectorAll('#sourceCheckboxList .child-item').forEach(item => {
        item.style.display = 'none';
      });
      // Hide all items when clearing
      document.querySelectorAll('#sourceCheckboxList .checkbox-item').forEach(item => {
        item.classList.add('hidden');
      });
      expandedParents.clear();
      updateCount('source');
    }

    // Clear section filters
    function clearSectionFilters() {
      document.querySelectorAll('#sectionsCheckboxList input[type="checkbox"]').forEach(cb => {
        cb.checked = false;
      });
      updateCount('section');
    }

    // Get selected sources
    function getSelectedSources() {
      const selected = [];
      document.querySelectorAll('#sourceCheckboxList input[type="checkbox"]:checked:not(#source_select_all)').forEach(cb => {
        selected.push(cb.nextElementSibling.textContent);
      });
      return selected;
    }

    // Get selected sections
    function getSelectedSections() {
      const selected = [];
      document.querySelectorAll('#sectionsCheckboxList input[type="checkbox"]:checked').forEach(cb => {
        selected.push(cb.nextElementSibling.textContent);
      });
      return selected;
    }

    // Debug function
    function logSelections() {
      console.log('Selected Sources:', getSelectedSources());
      console.log('Selected Sections:', getSelectedSections());
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', initializeSidebar);
  </script>
</body>

</html>